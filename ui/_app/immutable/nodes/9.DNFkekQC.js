import{s as J,d as p,i as N,g as H,j as W,k as C,a as k,b as u,l as _,c as v,e as S,f as $,h as y,t as P,o as K,n as O}from"../chunks/CKFRV2U2.js";import{S as Q,i as X,d as U,t as z,a as B,m as L,c as F,b as M}from"../chunks/C4UniOSA.js";import{e as T}from"../chunks/D6YF6ztN.js";import{C as Y}from"../chunks/D4AlWJD_.js";import{g as Z,a as ee,f as te,s as se}from"../chunks/Bz1-qmYa.js";import{F as ae}from"../chunks/CcuJL688.js";import{P as oe}from"../chunks/mq_gOYpb.js";import{R as V}from"../chunks/BemOOD-p.js";import{C as ne}from"../chunks/DW3dk5T8.js";import"../chunks/D5uLV3di.js";import"../chunks/CYzWA7jh.js";import{D as re}from"../chunks/0SjUiJWi.js";function j(r,e,a){const s=r.slice();return s[6]=e[a],s}function ie(r){let e,a=r[1].request.isNewProvider?"Authorize a new Provider":"Updated permissions requested",s;return{c(){e=y("span"),s=P(a),this.h()},l(o){e=v(o,"SPAN",{slot:!0,class:!0});var t=S(e);s=$(t,a),t.forEach(p),this.h()},h(){_(e,"slot","heading"),_(e,"class","text-[16px] font-bold")},m(o,t){N(o,e,t),u(e,s)},p(o,t){t&2&&a!==(a=o[1].request.isNewProvider?"Authorize a new Provider":"Updated permissions requested")&&k(s,a)},d(o){o&&p(e)}}}function le(r){let e,a,s=r[2].handle+"",o;return{c(){e=y("span"),a=y("span"),o=P(s),this.h()},l(t){e=v(t,"SPAN",{slot:!0});var n=S(e);a=v(n,"SPAN",{class:!0});var m=S(a);o=$(m,s),m.forEach(p),n.forEach(p),this.h()},h(){_(a,"class","text-[16px] font-semibold"),_(e,"slot","subheading")},m(t,n){N(t,e,n),u(e,a),u(a,o)},p(t,n){n&4&&s!==(s=t[2].handle+"")&&k(o,s)},d(t){t&&p(e)}}}function G(r){let e,a=r[6].description+"",s;return{c(){e=y("li"),s=P(a),this.h()},l(o){e=v(o,"LI",{class:!0});var t=S(e);s=$(t,a),t.forEach(p),this.h()},h(){_(e,"class","text-base font-normal")},m(o,t){N(o,e,t),u(e,s)},p:O,d(o){o&&p(e)}}}function ce(r){var R;let e,a,s,o,t=((R=r[1].request)==null?void 0:R.providerName)+"",n,m,f,i=new URL(document.referrer).hostname+"",g,w,A,x,q=T(r[3]),d=[];for(let l=0;l<q.length;l+=1)d[l]=G(j(r,q,l));return{c(){e=y("div"),a=y("div"),s=y("span"),o=P('By clicking "Next" and signing the resulting payload, you authorize the provider "'),n=P(t),m=P(`", operating from the domain
        `),f=y("a"),g=P(i),w=P(", to do the following"),A=W(),x=y("ul");for(let l=0;l<d.length;l+=1)d[l].c();this.h()},l(l){e=v(l,"DIV",{slot:!0});var b=S(e);a=v(b,"DIV",{});var h=S(a);s=v(h,"SPAN",{class:!0});var c=S(s);o=$(c,'By clicking "Next" and signing the resulting payload, you authorize the provider "'),n=$(c,t),m=$(c,`", operating from the domain
        `),f=v(c,"A",{class:!0,href:!0});var E=S(f);g=$(E,i),E.forEach(p),w=$(c,", to do the following"),c.forEach(p),A=H(h),x=v(h,"UL",{class:!0});var I=S(x);for(let D=0;D<d.length;D+=1)d[D].l(I);I.forEach(p),h.forEach(p),b.forEach(p),this.h()},h(){_(f,"class","underline"),_(f,"href",document.referrer),_(s,"class","text-base font-bold"),_(x,"class","list-disc pl-6 pt-3"),_(e,"slot","payloadDescription")},m(l,b){N(l,e,b),u(e,a),u(a,s),u(s,o),u(s,n),u(s,m),u(s,f),u(f,g),u(s,w),u(a,A),u(a,x);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(x,null)},p(l,b){var h;if(b&2&&t!==(t=((h=l[1].request)==null?void 0:h.providerName)+"")&&k(n,t),b&8){q=T(l[3]);let c;for(c=0;c<q.length;c+=1){const E=j(l,q,c);d[c]?d[c].p(E,b):(d[c]=G(E),d[c].c(),d[c].m(x,null))}for(;c<d.length;c+=1)d[c].d(1);d.length=q.length}},d(l){l&&p(e),K(d,l)}}}function de(r){let e;return{c(){e=P("Next > Sign")},l(a){e=$(a,"Next > Sign")},m(a,s){N(a,e,s)},d(a){a&&p(e)}}}function pe(r){let e,a,s,o;return e=new oe({props:{payload:r[0],$$slots:{payloadDescription:[ce],subheading:[le],heading:[ie]},$$scope:{ctx:r}}}),s=new ae({props:{$$slots:{default:[de]},$$scope:{ctx:r}}}),s.$on("click",r[4]),{c(){M(e.$$.fragment),a=W(),M(s.$$.fragment)},l(t){F(e.$$.fragment,t),a=H(t),F(s.$$.fragment,t)},m(t,n){L(e,t,n),N(t,a,n),L(s,t,n),o=!0},p(t,[n]){const m={};n&1&&(m.payload=t[0]),n&518&&(m.$$scope={dirty:n,ctx:t}),e.$set(m);const f={};n&512&&(f.$$scope={dirty:n,ctx:t}),s.$set(f)},i(t){o||(B(e.$$.fragment,t),B(s.$$.fragment,t),o=!0)},o(t){z(e.$$.fragment,t),z(s.$$.fragment,t),o=!1},d(t){t&&p(a),U(e,t),U(s,t)}}}function ue(r,e,a){let s,o,t;C(r,V,i=>a(1,s=i)),C(r,ne,i=>a(2,o=i)),C(r,Y,i=>a(5,t=i));let n,m=s.request.requiredSchemas.filter(({id:i})=>s.request.missingSchemas.some(g=>g===i)).map(i=>{const g=re.find(w=>w.name===i.name);return{...i,description:(g==null?void 0:g.description)||`Update data associated with the ${i.name} schema`}});Z(s.request.providerId,s.request.allSchemasToGrant).then(({bytes:i})=>{a(0,n=i)});async function f(){try{const i=await ee(t,o.account.address,n),g=(await te(o.account.address,{Sr25519:i.toString()},n)).toHex();V.upsertExtrinsic({pallet:"msa",extrinsicName:"grantDelegation",encodedExtrinsic:g}),await se(s.response)}catch(i){console.error("Payload not signed",i)}}return[n,s,o,m,f]}class qe extends Q{constructor(e){super(),X(this,e,ue,pe,J,{})}}export{qe as component};
