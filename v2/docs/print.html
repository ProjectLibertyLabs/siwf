<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Sign In With Frequency</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        <link rel="icon" href="images/favicon.ico" sizes="any" />
        <link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
        <link rel="manifest" href="images/manifest.webmanifest" />

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" type="image/svg+xml" href="favicon.svg">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts Remove Font-Awesome -->
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <!-- Removed -->

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="css/tailwind.css">
        <link rel="stylesheet" href="css/overrides.css">
        <link rel="stylesheet" href="css/side-nav.css">
        <link rel="stylesheet" href="css/button-links.css">
        <link rel="stylesheet" href="css/highlight.css">
        <link rel="stylesheet" href="css/highlight-dark.css">
        <link rel="stylesheet" href="css/generator.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "coal";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <!-- MOD: Move the sidebar-toggle-anchor outside of #body-container -->
    <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <header id="header">
        </header>

        <!-- MOD START: Updated sidebar code -->
        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
          <!-- populated by js -->
          <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
          <noscript>
              <style>
                #sidebar div {
                  overflow: hidden;
                }
              </style>
              <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
          </noscript>
      </nav>

      <!-- MOD: Move the sidebar resize handle out of the nav for the grid -->
      <div id="sidebar-resize-handle" class="sidebar-resize-handle">
          <div class="sidebar-resize-indicator"></div>
      </div>

      <!-- MOD: Move the menu-bar out of the page for the grid and remove sticky -->
      <div id="menu-bar-mod" class="menu-bar">
          <div class="left-buttons">
              <!-- MOD: Inject the specific fontawesome svgs -->
              <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                  <svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>
              </label>
              <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                  <svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M167.02 309.34c-40.12 2.58-76.53 17.86-97.19 72.3-2.35 6.21-8 9.98-14.59 9.98-11.11 0-45.46-27.67-55.25-34.35C0 439.62 37.93 512 128 512c75.86 0 128-43.77 128-120.19 0-3.11-.65-6.08-.97-9.13l-88.01-73.34zM457.89 0c-15.16 0-29.37 6.71-40.21 16.45C213.27 199.05 192 203.34 192 257.09c0 13.7 3.25 26.76 8.73 38.7l63.82 53.18c7.21 1.8 14.64 3.03 22.39 3.03 62.11 0 98.11-45.47 211.16-256.46 7.38-14.35 13.9-29.85 13.9-45.99C512 20.64 486 0 457.89 0z"/></svg>
              </button>
              <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                  <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                  <li role="none"><button role="menuitem" class="theme" id="coal">Dark</button></li>
              </ul>
                <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                <svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
              </button>
          </div>

          <h1 class="menu-title">Sign In With Frequency</h1>

          <div class="right-buttons">
              <a href="print.html" title="Print this book" aria-label="Print this book">
                  <i id="print-button" class="fa fa-print"></i>
              </a>
              <a href="https://github.com/ProjectLibertyLabs/siwf" title="Git repository" aria-label="Git repository">
                  <i id="git-repository-button" class="fa fa-github"></i>
              </a>

          </div>
      </div>
      <!-- MOD END: Updated sidebar code -->

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <!-- MOD: Move Header to outside the page-wrapper -->
                <div id="menu-bar-hover-placeholder"></div>
                <!-- MOD: Move Sidebar to > sidebar -->

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="sign-in-with-frequency-developer-documentation-and-tools"><a class="header" href="#sign-in-with-frequency-developer-documentation-and-tools">Sign In With Frequency Developer Documentation and Tools</a></h1>
<p>Sign In With Frequency (SIWF) provides documentation and tools to use with SIWF-compatible services such as <a href="https://frequencyaccess.com">Frequency Access</a> (an easy-to-use custodial social wallet for users on Frequency).</p>
<p><a href="./QuickStart.html">JavaScript Quick Start</a></p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>There are a few main steps to authenticating using SIWF-compatible systems.</p>
<p>For example, when using Frequency Access:</p>
<ol>
<li>Your application sends the user the Frequency Access Authentication URL</li>
<li>Frequency Access verifies the user, and the user signs the requested payload(s)</li>
<li>Frequency Access sends the signed user payloads back to your application</li>
<li>If needed, your application sends the signed payloads to Frequency</li>
<li>Your application logs in the user, and the user's session begins</li>
</ol>
<h3 id="actors"><a class="header" href="#actors">Actors</a></h3>
<ul>
<li>Your Application: Any website, mobile application, etc. for which your user needs authentication</li>
<li>SIWF service (e.g. Frequency Access): Verifies the user and provides the user with access to the entire Frequency Ecosystem</li>
<li>Frequency Blockchain: Manages user delegations and additional social operations</li>
</ul>
<h3 id="user-delegations-and-credentials"><a class="header" href="#user-delegations-and-credentials">User Delegations and Credentials</a></h3>
<p>SIWF allows you to request that a user give you various delegations such as private graph changes, and credentials such as verified email.</p>
<ul>
<li>See a full list of <a href="./Credentials.html">Available Credentials</a></li>
<li>See a full list of <a href="./Delegations.html">Available Delegations</a></li>
</ul>
<h2 id="staging--production"><a class="header" href="#staging--production">Staging &amp; Production</a></h2>
<h3 id="using-frequency-access"><a class="header" href="#using-frequency-access">Using Frequency Access</a></h3>
<p>Frequency Access has two deployments: Staging-Testnet and Production-Mainnet.</p>
<h4 id="production-mainnet"><a class="header" href="#production-mainnet">Production-Mainnet</a></h4>
<p>URL: <code>www.frequencyaccess.com</code></p>
<ul>
<li>Uses Frequency Mainnet</li>
<li>Supports both SMS and Email verification</li>
<li>Bot protection via <a href="https://www.hcaptcha.com/">hCaptcha</a></li>
<li>Authorization Timeout: 30 seconds</li>
</ul>
<h4 id="staging-testnet"><a class="header" href="#staging-testnet">Staging-Testnet</a></h4>
<p>URL: <code>testnet.frequencyaccess.com</code></p>
<ul>
<li>Uses Frequency Testnet on Paseo</li>
<li>Supports ONLY Email and will not send SMS verification codes</li>
<li>No uptime guarantees</li>
<li>Limited bot protection</li>
<li>May rate limit usage</li>
<li>Authorization Timeout: 30 seconds</li>
</ul>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<ul>
<li>Have registered your application as a <a href="https://provider.frequency.xyz">Provider on Frequency</a></li>
<li>Have access to a Frequency RPC Node</li>
</ul>
<h2 id="terms"><a class="header" href="#terms">Terms</a></h2>
<ul>
<li>Frequency Provider: The identity of the application registered on Frequency</li>
<li>Staging-Testnet: The staging environment</li>
<li>Production-Mainnet: The production environment</li>
<li>MSA: The Frequency blockchain account for a user</li>
<li>SR25519: Schnorr signatures using <code>ed25519</code> over ECDSA</li>
<li>Delegation: The user permission for an application to act on their behalf</li>
<li>Credential: Verified data about the user provided with permission of the user</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quick-start-with-javascript"><a class="header" href="#quick-start-with-javascript">Quick Start with JavaScript</a></h1>
<p>This quick start uses the <code>@projectlibertylabs/siwf</code> NPM package to quickly generate the request and validate the response from Frequency Access.</p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Install the NPM package.
This package is both CommonJS, ES Module, and TypeScript compatible.
TypeScript will be shown for the examples.</p>
<p><code>npm i @projectlibertylabs/siwf</code></p>
<h2 id="prerequisites-1"><a class="header" href="#prerequisites-1">Prerequisites</a></h2>
<ul>
<li>Generate a <a href="./Generate.html">Login Request Payload and Signature</a></li>
</ul>
<h2 id="step-1-generate-the-request-url"><a class="header" href="#step-1-generate-the-request-url">Step 1: Generate the Request URL</a></h2>
<pre><code class="language-typescript">import * as siwf from "@projectlibertylabs/siwf";

async function startLogin() {
  // Get the signed base64url encoded payload
  const signedRequest: string = getStaticProviderSignedRequest();

  // Any additional parameters that do not collide with reserved parameter names
  // on the Authentication URL are passed through unchanged.
  // Remember that ONLY the callback path from the Signed Payload is secured via signature.
  const additionalCallbackUrlParams: string = getWebOrApplicationCallbackUrlParams();

  // Options with endpoint selection
  // Endpoint may be tagged or specified in full
  const options = { endpoint: "production" };
  // Staging-Testnet Options
  // const options = { endpoint: 'staging' };

  const authenticationUrl = siwf.generateAuthenticationUrl(signedRequest, additionalCallbackUrlParams, options);
}
</code></pre>
<h2 id="step-2-web-forward-the-user-to-a-browser"><a class="header" href="#step-2-web-forward-the-user-to-a-browser">Step 2 (Web): Forward the User to a Browser</a></h2>
<p>For website interactions, just forward the user to the returned <code>authenticationUrl</code>.</p>
<h2 id="step-2-androidios-forward-the-user-to-an-embedded-browser"><a class="header" href="#step-2-androidios-forward-the-user-to-an-embedded-browser">Step 2 (Android/iOS): Forward the User to an Embedded Browser</a></h2>
<p><a href="./SDK/Overview.html">SDKs are provided</a> for Android and iOS to perform the correct redirects and callback setups using the proper interactions specific to these platforms.</p>
<h2 id="step-3-callback-processing"><a class="header" href="#step-3-callback-processing">Step 3: Callback Processing</a></h2>
<pre><code class="language-typescript">import * as siwf from "@projectlibertylabs/siwf";

async function handleCallback(incomingUrl: string) {
  // Extract the `authorizationCode` from the URL
  const url = new URL(incomingUrl);
  const authorizationCode = url.searchParams.get("authorizationCode");

  // Same options as before
  const options = { endpoint: "production" };

  // Exchange the `authorizationCode` for the result
  const result = await siwf.getLoginResult(authorizationCode, options);

  if (siwf.hasChainSubmissions(result)) {
    // Add your own logic for handling the submission to the chain
    await processSubmissions(result.payloads);
  }

  if (result.credentials) {
    // Add your own logic for processing credentials
    await processCredentials(result.credentials);
  }

  // Get the ss58 encoded key that identifies this session
  // It is also the control key for the user's constant MSA Id
  const userKey = result.userPublicKey.encodedValue;

  // Add your own logic for session managment
  startSession();
}
</code></pre>
<h2 id="step-4-session-starts"><a class="header" href="#step-4-session-starts">Step 4: Session Starts</a></h2>
<p>You now have a logged in user!
Assuming the chain submissions are complete, you also have:</p>
<ul>
<li>A consistent identifier, i.e. the MSA Id</li>
<li>A universal handle (If the user set one)</li>
<li>A public delegation between the user's MSA Id and your Provider Id on chain (revokable at any time by you or the user independently)</li>
</ul>
<p>And if requested:</p>
<ul>
<li>Access to the user's private graph</li>
<li>Permission to act on the user's behalf for delegated actions</li>
<li>Verified email or phone/SMS number for the user</li>
</ul>
<div class="warning">
Note: You may start the user’s session and process the submissions in the background, however some data such as the consistent identifier, the MSA Id or full handle with suffix may not be accessible until the processing is complete.
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="siwf-actions"><a class="header" href="#siwf-actions">SIWF Actions</a></h1>
<p>SIWF handles three different situations for each user:</p>
<div class="table-wrapper"><table><thead><tr><th>Action</th><th>Frequency Blockchain account (MSA)</th><th>Delegation with Your Application</th></tr></thead><tbody>
<tr><td>Create Account</td><td><em>Required</em></td><td><em>Required</em></td></tr>
<tr><td>Create Delegation</td><td>Existing</td><td><em>New or Updated Required</em></td></tr>
<tr><td>Login</td><td>Existing</td><td>Existing</td></tr>
</tbody></table>
</div>
<h2 id="general-flow"><a class="header" href="#general-flow">General Flow</a></h2>
<ol>
<li>Generate Provider Login Request Payload and Signature (<a href="Actions/../Generate.html">Generator Tool</a>) (<a href="Actions/../SignatureGeneration.html">Documentation</a>)</li>
<li>Build and send the user to the Authentication URL (<a href="Actions/./Start.html">See Details</a>)</li>
<li>Receive a callback from Frequency Access or other SIWF-compatible services</li>
<li>Retrieve and process the login response (<a href="Actions/./Response.html">See Details</a>)</li>
</ol>
<h3 id="sequence-diagram"><a class="header" href="#sequence-diagram">Sequence Diagram</a></h3>
<p><img src="Actions/./flow.svg" alt="General Flow Sequency Diagram" /></p>
<h2 id="backend-requirements"><a class="header" href="#backend-requirements">Backend Requirements</a></h2>
<ul>
<li>Able to validate payloads received from a SIWF-compatible services</li>
<li>Able to connect to a Frequency RPC Node</li>
<li>Able to sign transactions to submit to the Frequency RPC Node</li>
</ul>
<div class="button-links"><a href="Actions/Start.html">Start Login</a>
<a href="Actions/Response.html">Login Response</a></div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="redirect-user-to-a-siwf-compatible-service-eg-frequency-access"><a class="header" href="#redirect-user-to-a-siwf-compatible-service-eg-frequency-access">Redirect User to a SIWF-Compatible Service (e.g. Frequency Access)</a></h1>
<p>To start the authentication loop, your application will generate an Authentication URL for each user.</p>
<p>Note: The following instruction examples are based on Frequency Access.</p>
<h2 id="quick-reference"><a class="header" href="#quick-reference">Quick Reference</a></h2>
<ul>
<li>Staging-Testnet: <code>https://testnet.frequencyaccess.com/siwa/start</code></li>
<li>Production-Mainnet: <code>https://www.frequencyaccess.com/siwa/start</code></li>
<li>Generate Login Request Payload and Signature: <a href="Actions/../Generate.html">Generator Tool</a></li>
<li>Request Structure: <a href="Actions/../DataStructures/All.html#request"><code>SiwfRequest</code></a></li>
<li>Signed Request Structure: <a href="Actions/../DataStructures/All.html#signed-request"><code>SiwfSignedRequest</code></a></li>
</ul>
<h2 id="step-1-generate-the-signed-request-payload"><a class="header" href="#step-1-generate-the-signed-request-payload">Step 1: Generate the Signed Request Payload</a></h2>
<p>You <em>can</em> generate more than one of these to use simultaneously.
Most applications should generate and keep their needed value(s) static.
The generated signed request payload is secured by the signature included in it, and it is not sensitive data.</p>
<h3 id="signed-request-payload-contents"><a class="header" href="#signed-request-payload-contents">Signed Request Payload Contents</a></h3>
<ul>
<li>A signature from one of the <a href="https://docs.frequency.xyz/Identity/ControlKeys.html">Control Keys</a> of the Frequency Provider</li>
<li>The domain and path the callback will use</li>
<li>The requested permissions</li>
<li>The requested credentials</li>
</ul>
<h3 id="signed-request-payload-generator"><a class="header" href="#signed-request-payload-generator">Signed Request Payload Generator</a></h3>
<p>Generate one or more login request payloads and signatures (<code>signedRequest</code>) using the <a href="Actions/../Generate.html">Generator Tool</a>.</p>
<h3 id="signed-request-payload-detailed-documentation"><a class="header" href="#signed-request-payload-detailed-documentation">Signed Request Payload Detailed Documentation</a></h3>
<p>For details on the Payload and how it is formed, see the <a href="Actions/../SignatureGeneration.html">Reference Documentation</a>.</p>
<h2 id="step-2-build-the-authentication-url-parameters"><a class="header" href="#step-2-build-the-authentication-url-parameters">Step 2: Build the Authentication URL Parameters</a></h2>
<h3 id="parameter-signedrequest"><a class="header" href="#parameter-signedrequest">Parameter: <code>signedRequest</code></a></h3>
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-5">Base64url</a> encoded value from Step 1.</p>
<p>Reminder: This includes the callback domain that will be used.</p>
<h3 id="additional-parameters-are-forwarded"><a class="header" href="#additional-parameters-are-forwarded">Additional Parameters are Forwarded</a></h3>
<p>Any additional parameters that do not collide with reserved parameter names on the Authentication URL are passed through unchanged.</p>
<div class="warning">
Note: These parameters are not protected and could be changed by malicious actors.
Take care when using them for security-related data.
</div>
<h4 id="example"><a class="header" href="#example">Example</a></h4>
<ul>
<li><code>https://www.frequencyaccess.com/siwa/start?signedRequest=&lt;request value&gt;&amp;key1=&lt;value1&gt;&amp;key2=&lt;value2&gt;&amp;other=&lt;result&gt;</code></li>
<li>Will result in callback URL parameters of: <code>?authorizationCode=&lt;authorization code&gt;&amp;key1=&lt;value1&gt;&amp;key2=&lt;value2&gt;&amp;other=&lt;result&gt;</code></li>
</ul>
<h2 id="step-3-build-the-authentication-url"><a class="header" href="#step-3-build-the-authentication-url">Step 3: Build the Authentication URL</a></h2>
<p>Taking the parameters from the previous step, build an Authentication URL using the correct base for the SIWF path of <code>/start</code>:</p>
<ul>
<li>Staging-Testnet: <code>https://testnet.frequencyaccess.com/siwa/start</code></li>
<li>Production-Mainnet: <code>https://www.frequencyaccess.com/siwa/start</code></li>
</ul>
<p>The SIWF System will send the user back by building the callback URL.
The callback URL will be built with:</p>
<ul>
<li>The callback from the <code>signedRequest</code></li>
<li>Appending any additional GET request parameters</li>
<li>Appending the reserved URL parameter of <code>authorizationCode</code></li>
</ul>
<p>The callback URL <em>will maintain</em> all non-reserved URL parameters.
For example, if you wish to correlate the original unauthorized session with the authorized session, you can generate a dynamic parameter with a random UUIDv4 identifier on each request.</p>
<h3 id="example-1"><a class="header" href="#example-1">Example</a></h3>
<p>Parameters</p>
<pre><code class="language-json">{
  "signedRequest": "eyJyZXF1ZXN0ZWRTaWduYXR1cmVzIjp7InB1YmxpY0tleSI6eyJlbmNvZGVkVmFsdWUiOiJmNmNMNHdxMUhVTngxMVRjdmRBQk5mOVVOWFhveUg0N21WVXdUNTl0elNGUlc4eURIIiwiZW5jb2RpbmciOiJiYXNlNTgiLCJmb3JtYXQiOiJzczU4IiwidHlwZSI6IlNyMjU1MTkifSwic2lnbmF0dXJlIjp7ImFsZ28iOiJTUjI1NTE5IiwiZW5jb2RpbmciOiJiYXNlMTYiLCJlbmNvZGVkVmFsdWUiOiIweDk2MGYxOTVkYzFmOTFiZjcxYzBiMzUyMzE1MGFlMzc0NzFiZWRlMDdhMDAzOTA5NjQ3Y2NmMDQwYWNkNWNkMDRlYTQ4NzBiZDEyNGNhZmEyZGViNTliMGUzNzhjYjE5ZmJjNmFmNjAxYjc1NTU5ZmFhYjdiNzY4ZGU4MWEwOTgzIn0sInBheWxvYWQiOnsiY2FsbGJhY2siOiJodHRwOi8vbG9jYWxob3N0OjMwMDAiLCJwZXJtaXNzaW9ucyI6WzUsNyw4LDksMTBdfX0sInJlcXVlc3RlZENyZWRlbnRpYWxzIjpbeyJ0eXBlIjoiVmVyaWZpZWRHcmFwaEtleUNyZWRlbnRpYWwiLCJoYXNoIjpbImJjaXFtZHZteGQ1NHp2ZTVraWZ5Y2dzZHRvYWhzNWVjZjRoYWwydHMzZWV4a2dvY3ljNW9jYTJ5Il19LHsiYW55T2YiOlt7InR5cGUiOiJWZXJpZmllZEVtYWlsQWRkcmVzc0NyZWRlbnRpYWwiLCJoYXNoIjpbImJjaXFlNHFvY3poZnRpY2k0ZHpmdmZiZWw3Zm80aDRzcjVncmNvM29vdnd5azZ5NHluZjQ0dHNpIl19LHsidHlwZSI6IlZlcmlmaWVkUGhvbmVOdW1iZXJDcmVkZW50aWFsIiwiaGFzaCI6WyJiY2lxanNwbmJ3cGMzd2p4NGZld2NlazVkYXlzZGpwYmY1eGppbXo1d251NXVqN2UzdnUydXducSJdfV19XX0",
  "mode": "dark"
}
</code></pre>
<p>Testnet Authentication URL</p>
<pre><code class="language-json">"https://testnet.frequencyaccess.com/siwa/start?signedRequest=eyJyZXF1ZXN0ZWRTaWduYXR1cmVzIjp7InB1YmxpY0tleSI6eyJlbmNvZGVkVmFsdWUiOiJmNmNMNHdxMUhVTngxMVRjdmRBQk5mOVVOWFhveUg0N21WVXdUNTl0elNGUlc4eURIIiwiZW5jb2RpbmciOiJiYXNlNTgiLCJmb3JtYXQiOiJzczU4IiwidHlwZSI6IlNyMjU1MTkifSwic2lnbmF0dXJlIjp7ImFsZ28iOiJTUjI1NTE5IiwiZW5jb2RpbmciOiJiYXNlMTYiLCJlbmNvZGVkVmFsdWUiOiIweDk2MGYxOTVkYzFmOTFiZjcxYzBiMzUyMzE1MGFlMzc0NzFiZWRlMDdhMDAzOTA5NjQ3Y2NmMDQwYWNkNWNkMDRlYTQ4NzBiZDEyNGNhZmEyZGViNTliMGUzNzhjYjE5ZmJjNmFmNjAxYjc1NTU5ZmFhYjdiNzY4ZGU4MWEwOTgzIn0sInBheWxvYWQiOnsiY2FsbGJhY2siOiJodHRwOi8vbG9jYWxob3N0OjMwMDAiLCJwZXJtaXNzaW9ucyI6WzUsNyw4LDksMTBdfX0sInJlcXVlc3RlZENyZWRlbnRpYWxzIjpbeyJ0eXBlIjoiVmVyaWZpZWRHcmFwaEtleUNyZWRlbnRpYWwiLCJoYXNoIjpbImJjaXFtZHZteGQ1NHp2ZTVraWZ5Y2dzZHRvYWhzNWVjZjRoYWwydHMzZWV4a2dvY3ljNW9jYTJ5Il19LHsiYW55T2YiOlt7InR5cGUiOiJWZXJpZmllZEVtYWlsQWRkcmVzc0NyZWRlbnRpYWwiLCJoYXNoIjpbImJjaXFlNHFvY3poZnRpY2k0ZHpmdmZiZWw3Zm80aDRzcjVncmNvM29vdnd5azZ5NHluZjQ0dHNpIl19LHsidHlwZSI6IlZlcmlmaWVkUGhvbmVOdW1iZXJDcmVkZW50aWFsIiwiaGFzaCI6WyJiY2lxanNwbmJ3cGMzd2p4NGZld2NlazVkYXlzZGpwYmY1eGppbXo1d251NXVqN2UzdnUydXducSJdfV19XX0&amp;mode=dark"
</code></pre>
<h2 id="step-4-redirect-the-user"><a class="header" href="#step-4-redirect-the-user">Step 4: Redirect the User</a></h2>
<ul>
<li>Redirect the user's Browser or Embedded Browser (for mobile apps) to the Authentication URL.
<ul>
<li><a href="https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller">SafariViewController for iOS</a></li>
<li><a href="https://developer.chrome.com/docs/android/custom-tabs/">Chrome Custom Tabs for Android</a></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-the-login-result-from-siwf"><a class="header" href="#getting-the-login-result-from-siwf">Getting the Login Result from SIWF</a></h1>
<p>After the user completes the authentication and authorization, the user is redirected to the callback URL with one additional parameter set: <code>authorizationCode</code>.</p>
<p>The <code>authorizationCode</code> can be used to retrieve the result of the login.</p>
<p>Note: The following instruction examples are based on Frequency Access.</p>
<h2 id="quick-reference-1"><a class="header" href="#quick-reference-1">Quick Reference</a></h2>
<ul>
<li>Staging-Testnet: <code>https://testnet.frequencyaccess.com/siwa/api/payload</code></li>
<li>Production-Mainnet: <code>https://www.frequencyaccess.com/siwa/api/payload</code></li>
<li>Response Structure: <a href="Actions/../DataStructures/All.html#response"><code>SiwfResponse</code></a></li>
</ul>
<h2 id="step-1-retrieve-the-response"><a class="header" href="#step-1-retrieve-the-response">Step 1: Retrieve the Response</a></h2>
<ul>
<li><code>GET</code>:
<ul>
<li>Staging-Testnet: <code>https://testnet.frequencyaccess.com/siwa/api/payload?authorizationCode=[Parameter from callback URL]</code></li>
<li>Production-Mainnet: <code>https://www.frequencyaccess.com/siwa/api/payload?authorizationCode=[Parameter from callback URL]</code></li>
</ul>
</li>
</ul>
<h2 id="step-2-parsing-the-response"><a class="header" href="#step-2-parsing-the-response">Step 2: Parsing the Response</a></h2>
<p>Response Sections</p>
<ul>
<li><code>userPublicKey</code>: The key for the user signing this request</li>
<li><code>payloads</code>: Signed payloads from the user</li>
<li><code>credentials</code>: User-approved, verified credentials from Frequency Access (or other SIWF-compatible services) such as email, phone, user keys, etc...</li>
</ul>
<h3 id="userpublickey"><a class="header" href="#userpublickey"><code>userPublicKey</code></a></h3>
<p>The user for the current session is identified via the public key.
If the user has a Frequency blockchain account (MSA), the user’s MSA Id can be retrieved from Frequency via this key.
If the user does not have an account, the payloads section with contain the payload to create the MSA Id.</p>
<p>While the <code>userPublicKey</code> may change, the MSA Id will <em>always</em> be the same for the same user account.</p>
<h2 id="step-3-processing-the-credentials"><a class="header" href="#step-3-processing-the-credentials">Step 3: Processing the Credentials</a></h2>
<p>The <code>credentials</code> array will contain any <a href="Actions/../SignatureGeneration.html#step-3-optional-request-credentials-graph-key-email-phone">requested</a> and approved credentials.
Each credential would be matched based on the <code>type</code> field.</p>
<p>These credentials follow the <a href="https://spec.dsnp.org/VerifiableCredentials/Overview.html">DSNP Verifiable Credentials Specification</a>.</p>
<ul>
<li><a href="https://github.com/LibertyDSNP/dsnp-verifiable-credentials"><code>@dsnp/verifiable-credentials</code></a> TypeScript library for verifying these DSNP Credentials specifically</li>
<li>Other <a href="https://www.w3.org/TR/vc-data-model-1.1/">W3C Verifiable Credentials</a> verifiers may also be compatible.</li>
</ul>
<h3 id="verify-the-credential"><a class="header" href="#verify-the-credential">Verify the Credential</a></h3>
<p><em>Trust Model Note</em>: You may choose to just trust credentials issued by Frequency Access (or other SIWF-compatible services) given that the credential is fetched directly. These will have issuer <code>did:web:testnet.frequencyaccess.com</code> or <code>did:web:frequencyaccess.com</code>.</p>
<ol>
<li>Check that the <code>credentialSubject.id</code> matches the <code>userPublicKey</code> following the <a href="https://w3c-ccg.github.io/did-key-spec/#format"><code>did:key</code> Method from the W3C</a></li>
</ol>
<ul>
<li>Example: <code>f6cL4wq1HUNx11TcvdABNf9UNXXoyH47mVUwT59tzSFRW8yDH</code> is the <a href="https://docs.substrate.io/reference/address-formats/">SS58</a> version with prefix <code>90</code> of the hex address <code>0xd43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d</code>. <code>0xef01d43593c715fdd31c61141abd04a99fd6822c8558854ccde39a5684e7a56da27d</code> is multicodec <code>sr25519-pub</code> hex which is multiformat <code>base58-btc</code> <code>z6QNzHod3tSSJbwo4e5xGDcnsndsR9WByZzPoCGdbv3sv1jJ</code></li>
</ul>
<ol start="2">
<li>Fetch the issuer DID Document following the <a href="https://w3c-ccg.github.io/did-method-web/"><code>did:web</code> Method from the W3C</a></li>
</ol>
<ul>
<li>Production-Mainnet should always be <code>did:web:frequencyaccess.com</code> which resolves to <code>https://frequencyaccess.com/.well-known/did.json</code></li>
<li>Staging-Testnet should always be <code>did:web:testnet.frequencyaccess.com</code> which resolves to <code>https://testnet.frequencyaccess.com/.well-known/did.json</code></li>
</ul>
<ol start="3">
<li>Check that the key in the <code>proof.verificationMethod</code> is in the DID Document to verify that the key is still valid</li>
<li>Test that the <code>proof</code> validates according the to <a href="https://www.w3.org/TR/vc-data-model-1.1/#verification">W3C Verifiable Credentials Specification</a></li>
</ol>
<h2 id="graph-encryption-key-credential"><a class="header" href="#graph-encryption-key-credential">Graph Encryption Key Credential</a></h2>
<p>If the user has permitted access to their private social graph per the request for <code>VerifiedGraphKeyPairCredential</code>, <code>credentials</code> will have a entry with <code>type</code> including <code>VerifiedGraphKeyPairCredential</code>.
This is an <code>x25519</code> key pair for use with the <code>curve25519xsalsa20poly1305</code> encryption algorithm from the <a href="http://nacl.cr.yp.to">NaCl Library</a>.
For more information on how the Graph data is structured after decryption, see the <a href="https://spec.dsnp.org/DSNP/UserData.html">DSNP Specification</a>.</p>
<p>This key pair is PII and should be stored with care, but must be stored to read the user's private graph.</p>
<h3 id="example-credential"><a class="header" href="#example-credential">Example Credential</a></h3>
<pre><code class="language-json">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/undefined-terms/v2"
  ],
  "type": [
    "VerifiedPhoneNumberCredential",
    "VerifiableCredential"
  ],
  "issuer": "did:web:frequencyaccess.com",
  "validFrom": "2024-08-21T21:28:08.289+0000",
  "credentialSchema": {
    "type": "JsonSchema",
    "id": "https://schemas.frequencyaccess.com/VerifiedPhoneNumberCredential/bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq.json"
  },
  "credentialSubject": {
    "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
    "phoneNumber": "+01-234-867-5309",
    "lastVerified": "2024-08-21T21:27:59.309+0000"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
    "cryptosuite": "eddsa-rdfc-2022",
    "proofPurpose": "assertionMethod",
    "proofValue": "z5sJ2CjHX1wwgzfFGoZNocxeFKd2ffpo5TVgUvdaSkYq1M6gF7UjpYfePo97QoZgmiWdgPAWPjxFvGBysaxHV8DZ4"
  }
}
</code></pre>
<h2 id="step-4-processing-the-payloads"><a class="header" href="#step-4-processing-the-payloads">Step 4: Processing the Payloads</a></h2>
<p>The payload section has several different types that can be returned:</p>
<ul>
<li><code>login</code>: When the user already has a correct delegation</li>
<li><code>addProvider</code>*: When the user does not have a delegation (a new user signup) or when the delegation was needing to be changed</li>
<li><code>itemActions</code>*: When the user has user chain data to set or update</li>
<li><code>claimHandle</code>*: When the user needs to claim a new handle</li>
</ul>
<p>* Requires submission to Frequency</p>
<p>The payloads that require submission to Frequency should be submitted in one batch using <a href="https://docs.frequency.xyz/Tokenomics/ProviderIncentives.html#capacity-model">Capacity</a>.
The <code>addProvider</code> <em>must</em> always be <em>first</em> in the batch to ensure the correct permissions and delegations are in place for subsequent actions in the batch.</p>
<p>Signatures to Frequency have an expiration set to a future Frequency block number.
If the actions are not submitted before expiration, Frequency will reject the transactions and your application will need to request new signatures.</p>
<p><a href="Actions/../Payloads.html">Payload Examples and Signature Details</a></p>
<h3 id="login"><a class="header" href="#login"><code>login</code></a></h3>
<p>The correct delegation for the user already exists.
No submission to the chain is required, but the application <em>must</em> validate the signature to be sure that the user is authenticated.</p>
<p>The message signed follows <a href="https://chainagnostic.org/CAIPs/caip-122">CAIP-122: Sign in With X</a> specification which is derived from <a href="https://eips.ethereum.org/EIPS/eip-4361">EIP-4361: Sign-In with Ethereum</a>.</p>
<h4 id="example-message-with-placeholders"><a class="header" href="#example-message-with-placeholders">Example Message with Placeholders</a></h4>
<pre><code class="language-text">{{domain}} wants you to sign in with your Frequency account:
frequency:{{chainReference}}:{{ss58Address}}

URI: {{uri}}
Version: {{version}}
Nonce: {{nonce}}
Chain ID: frequency:{{chainReference}}
Issued At: {{issued-at}}
</code></pre>
<p>Inside the message, <code>{{domain}}</code> is the domain of the application requesting the sign in. <code>{{domain}}</code> should match the domain contained in the <code>URI</code> field.</p>
<h4 id="validation-steps"><a class="header" href="#validation-steps">Validation Steps</a></h4>
<ol>
<li>Perform an Sr25519 signature verification using:
<ul>
<li><code>userPublicKey</code>: The signing key</li>
<li><code>payload.message</code>: The signed message parsing <code>\n</code> into <code>LF</code> line breaks</li>
<li><code>signature.encodedValue</code>: The signature</li>
</ul>
</li>
<li>Verify that the <code>userPublicKey</code> matches the second line of the message for the correct chain identifier
<ul>
<li>Production-Mainnet: <code>frequency:mainnet:</code></li>
<li>Staging-Testnet: <code>frequency:testnet-paseo:</code></li>
</ul>
</li>
<li>Verify that the message starts with your domain based on <a href="https://www.rfc-editor.org/rfc/rfc4501.html">RFC 4501</a> <code>dnsauthority</code></li>
<li>Verify the <code>Issued At</code> value from the message is within your acceptable time range</li>
<li>Verify that <code>Nonce</code> value in the message is not being reused</li>
</ol>
<h4 id="parsing-the-message-data"><a class="header" href="#parsing-the-message-data">Parsing the Message Data</a></h4>
<ol>
<li>Break the lines by <code>\n</code></li>
<li>Match based on the prefix:
<ul>
<li><code>Nonce: </code></li>
<li><code>Issued At: </code></li>
<li><code>URI: </code></li>
</ul>
</li>
</ol>
<h3 id="addprovider"><a class="header" href="#addprovider"><code>addProvider</code></a></h3>
<p>The user either needs a new delegation or a new MSA created with the delegation.</p>
<p>The <code>endpoint.extrinsic</code> field will distinguish between the two:</p>
<ul>
<li><code>createSponsoredAccountWithDelegation</code>: New MSA</li>
<li><code>grantDelegation</code>: New/Updated Delegation</li>
</ul>
<p><a href="https://frequency-chain.github.io/frequency/pallet_msa/index.html#extrinsics">See Frequency Documentation</a> on forming the transaction for the extrinsics.</p>
<h3 id="itemactions"><a class="header" href="#itemactions"><code>itemActions</code></a></h3>
<p>Item actions will update the user's chain data for things such as their public key for the encrypted graph.
These actions <em>must</em> be submitted to the chain for the correct functioning of private graph and other systems.</p>
<p><a href="https://frequency-chain.github.io/frequency/pallet_stateful_storage/index.html#extrinsics">See Frequency Documentation</a> on forming the transaction for the extrinsics.</p>
<h3 id="claimhandle"><a class="header" href="#claimhandle"><code>claimHandle</code></a></h3>
<p>The user wishes to claim a Frequency Handle.</p>
<p><a href="https://frequency-chain.github.io/frequency/pallet_handles/index.html#extrinsics">See Frequency Documentation</a> on forming the transaction for the extrinsics.</p>
<h2 id="step-5-frequency-transaction-submission"><a class="header" href="#step-5-frequency-transaction-submission">Step 5: Frequency Transaction Submission</a></h2>
<p>All payloads that are returned will be able to be processed using <a href="https://frequency-chain.github.io/frequency/pallet_frequency_tx_payment/index.html#extrinsics">Capacity on Frequency</a>.</p>
<p>Frequency submission is required for any of the following payloads:</p>
<ul>
<li><code>addProvider</code></li>
<li><code>itemActions</code></li>
<li><code>claimHandle</code></li>
</ul>
<p>They can be submitted to the chain in one transaction using <a href="https://frequency-chain.github.io/frequency/pallet_frequency_tx_payment/index.html#extrinsics"><code>pay_with_capacity_batch_all</code></a>.</p>
<h2 id="step-6-session-starts"><a class="header" href="#step-6-session-starts">Step 6: Session Starts</a></h2>
<p>Once the payloads have been validated, the user's authenticated session may start.
SIWF services do not manage user sessions.</p>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<h2 id="new-frequency-user-response"><a class="header" href="#new-frequency-user-response">New Frequency User Response</a></h2>
<pre><code class="language-json">{
  "userPublicKey": {
    "encodedValue": "f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ",
    "encoding": "base58",
    "format": "ss58",
    "type": "Sr25519"
  },
  "payloads": [
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0x1a27cb6d79b508e1ffc8d6ae70af78d5b3561cdc426124a06f230d7ce70e757e1947dd1bac8f9e817c30676a5fa6b06510bae1201b698b044ff0660c60f18c8a"
      },
      "endpoint": {
        "pallet": "msa",
        "extrinsic": "createSponsoredAccountWithDelegation"
      },
      "type": "addProvider",
      "payload": {
        "authorizedMsaId": 1,
        "schemaIds": [
          5,
          7,
          8,
          9,
          10
        ],
        "expiration": 24
      }
    },
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0x9eb338773b386ded2e3731ba68ba734c80408b3ad24f92ed3c60342d374a32293851fa8e41d722c72a5a4e765a9e401c68570a8c666ab678e4e5d94aa6825d85"
      },
      "endpoint": {
        "pallet": "statefulStorage",
        "extrinsic": "applyItemActionsWithSignatureV2"
      },
      "type": "itemActions",
      "payload": {
        "schemaId": 7,
        "targetHash": 0,
        "expiration": 20,
        "actions": [
          {
            "type": "addItem",
            "payloadHex": "0x40eea1e39d2f154584c4b1ca8f228bb49ae5a14786ed63c90025e755f16bd58d37"
          }
        ]
      }
    },
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0xb004140fd8ba3395cf5fcef49df8765d90023c293fde4eaf2e932cc24f74fc51b006c0bebcf31d85565648b4881fa22115e0051a3bdb95ab5bf7f37ac66f798f"
      },
      "endpoint": {
        "pallet": "handles",
        "extrinsic": "claimHandle"
      },
      "type": "claimHandle",
      "payload": {
        "baseHandle": "ExampleHandle",
        "expiration": 24
      }
    }
  ],
  "credentials": [
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedEmailAddressCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:web:frequencyaccess.com",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "emailAddress": "john.doe@example.com",
        "lastVerified": "2024-08-21T21:27:59.309+0000"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z4jArnPwuwYxLnbBirLanpkcyBpmQwmyn5f3PdTYnxhpy48qpgvHHav6warjizjvtLMg6j3FK3BqbR2nuyT2UTSWC"
      }
    },
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedGraphKeyCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "encodedPublicKeyValue": "0xb5032900293f1c9e5822fd9c120b253cb4a4dfe94c214e688e01f32db9eedf17",
        "encodedPrivateKeyValue": "0xd0910c853563723253c4ed105c08614fc8aaaf1b0871375520d72251496e8d87",
        "encoding": "base16",
        "format": "bare",
        "type": "X25519",
        "keyType": "dsnp.public-key-key-agreement"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:key:z6MktZ15TNtrJCW2gDLFjtjmxEdhCadNCaDizWABYfneMqhA",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z2HHWwtWggZfvGqNUk4S5AAbDGqZRFXjpMYAsXXmEksGxTk4DnnkN3upCiL1mhgwHNLkxY3s8YqNyYnmpuvUke7jF"
      }
    }
  ]
}
</code></pre>
<h2 id="new-applicationdelegation-response"><a class="header" href="#new-applicationdelegation-response">New Application/Delegation Response</a></h2>
<pre><code class="language-json">{
  "userPublicKey": {
    "encodedValue": "f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ",
    "encoding": "base58",
    "format": "ss58",
    "type": "Sr25519"
  },
  "payloads": [
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0xbac399831b9e3ad464a16e62ad1252cc8344a2c52f80252b2aa450a06ae2362f6f4afcaca791a81f28eaa99080e2654bdbf1071a276213242fc153cca43cfa8e"
      },
      "endpoint": {
        "pallet": "msa",
        "extrinsic": "grantDelegation"
      },
      "type": "addProvider",
      "payload": {
        "authorizedMsaId": 1,
        "schemaIds": [
          5,
          7,
          8,
          9,
          10
        ],
        "expiration": 24
      }
    }
  ],
  "credentials": [
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedEmailAddressCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:web:frequencyaccess.com",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "emailAddress": "john.doe@example.com",
        "lastVerified": "2024-08-21T21:27:59.309+0000"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z4jArnPwuwYxLnbBirLanpkcyBpmQwmyn5f3PdTYnxhpy48qpgvHHav6warjizjvtLMg6j3FK3BqbR2nuyT2UTSWC"
      }
    },
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedGraphKeyCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "encodedPublicKeyValue": "0xb5032900293f1c9e5822fd9c120b253cb4a4dfe94c214e688e01f32db9eedf17",
        "encodedPrivateKeyValue": "0xd0910c853563723253c4ed105c08614fc8aaaf1b0871375520d72251496e8d87",
        "encoding": "base16",
        "format": "bare",
        "type": "X25519",
        "keyType": "dsnp.public-key-key-agreement"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:key:z6MktZ15TNtrJCW2gDLFjtjmxEdhCadNCaDizWABYfneMqhA",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z2HHWwtWggZfvGqNUk4S5AAbDGqZRFXjpMYAsXXmEksGxTk4DnnkN3upCiL1mhgwHNLkxY3s8YqNyYnmpuvUke7jF"
      }
    }
  ]
}
</code></pre>
<h2 id="login-only-response"><a class="header" href="#login-only-response">Login Only Response</a></h2>
<pre><code class="language-json">{
  "userPublicKey": {
    "encodedValue": "f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ",
    "encoding": "base58",
    "format": "ss58",
    "type": "Sr25519"
  },
  "payloads": [
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0xe261698297111834e68b4152bf1f89819e886b6528f6fff45715f7781d0f1e7dc4007ccfed1e85b8c603c0fea2f7abf22bfe6336869ad21f11a09a114452c680"
      },
      "type": "login",
      "payload": {
        "message": "your-app.com wants you to sign in with your Frequency account:\nf6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ\n\n\n\nURI: https://your-app.com/signin/callback\nNonce: N6rLwqyz34oUxJEXJ\nIssued At: 2024-10-29T19:17:27.077Z\nExpiration Time: 2060-03-05T23:23:03.041Z"
      }
    }
  ],
  "credentials": [
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedEmailAddressCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:web:frequencyaccess.com",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "emailAddress": "john.doe@example.com",
        "lastVerified": "2024-08-21T21:27:59.309+0000"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z4jArnPwuwYxLnbBirLanpkcyBpmQwmyn5f3PdTYnxhpy48qpgvHHav6warjizjvtLMg6j3FK3BqbR2nuyT2UTSWC"
      }
    },
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedGraphKeyCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "encodedPublicKeyValue": "0xb5032900293f1c9e5822fd9c120b253cb4a4dfe94c214e688e01f32db9eedf17",
        "encodedPrivateKeyValue": "0xd0910c853563723253c4ed105c08614fc8aaaf1b0871375520d72251496e8d87",
        "encoding": "base16",
        "format": "bare",
        "type": "X25519",
        "keyType": "dsnp.public-key-key-agreement"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:key:z6MktZ15TNtrJCW2gDLFjtjmxEdhCadNCaDizWABYfneMqhA",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z2HHWwtWggZfvGqNUk4S5AAbDGqZRFXjpMYAsXXmEksGxTk4DnnkN3upCiL1mhgwHNLkxY3s8YqNyYnmpuvUke7jF"
      }
    }
  ]
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reference"><a class="header" href="#reference">Reference</a></h1>
<ul>
<li><a href="./Generate.html">Signed Request Generator Tool</a></li>
<li><a href="./SignatureGeneration.html">Signed Request</a></li>
<li><a href="./Credentials.html">Available Credentials</a></li>
<li><a href="./Delegations.html">Available Delegations</a></li>
<li><a href="./Payloads.html">Signed Payloads</a></li>
<li><a href="./DataStructures/All.html">Data Structures and Examples</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="signed-request-generator"><a class="header" href="#signed-request-generator">Signed Request Generator</a></h1>
<p>Fill out the form and the signed request will be generated at the bottom.</p>
<div id="generator">
<link href="./Generator/_app/immutable/assets/0.tn0RQdqM.css" rel="stylesheet">
<link rel="modulepreload" href="./Generator/_app/immutable/entry/start.CpeorHy4.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/Cbgb5qQp.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/CgqYYNKe.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/BwsSu_VZ.js">
<link rel="modulepreload" href="./Generator/_app/immutable/entry/app.DonfCnB5.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/-AvFmrNB.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/D7z_nF4p.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/CL5X56dl.js">
<link rel="modulepreload" href="./Generator/_app/immutable/nodes/0.9NHzt5Sy.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/Boo8G1f3.js">
<link rel="modulepreload" href="./Generator/_app/immutable/nodes/2.Dxg1spkg.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/DDPItZwv.js">
<link rel="modulepreload" href="./Generator/_app/immutable/chunks/nb5uAOaO.js"> <!--[--><!--[--><!----><div><!----><!----><div class="mb-4"><form><div class="mb-4"><label for="callbackUri">Callback URI *</label> <input type="url" id="callbackUri" value="" required placeholder="https://localhost:3000/login"/></div> <div class="mb-4"><fieldset><legend>Permissions</legend> <div class="checkboxes"><!--[--><label><input type="checkbox" value="8,10,9,7"/> <!---->Bundle: Public & Private Graph <span title="dsnp.public-follows@v1, dsnp.private-connections@v1, dsnp.private-follows@v1, dsnp.public-key-key-agreement@v1">ⓘ</span><!----></label><label><input type="checkbox" value="17,18,16,4,19"/> <!---->Bundle: DSNP v1.3 Content <span title="dsnp.broadcast@v2, dsnp.reply@v2, dsnp.tombstone@v2, dsnp.reaction@v1, dsnp.update@v2">ⓘ</span><!----></label><label><input type="checkbox" value="2,3,1,4,5"/> <!---->(Deprecated) Bundle: DSNP v1.0 Content <span title="dsnp.broadcast@v1, dsnp.reply@v1, dsnp.tombstone@v1, dsnp.reaction@v1, dsnp.update@v1">ⓘ</span><!----></label><label><input type="checkbox" value="2"/> <!---->(Deprecated) dsnp.broadcast: Create new public content (v1)<!----></label><label><input type="checkbox" value="6"/> <!---->(Deprecated) dsnp.profile: Update profile information (v1)<!----></label><label><input type="checkbox" value="3"/> <!---->(Deprecated) dsnp.reply: Public reply to content (v1)<!----></label><label><input type="checkbox" value="1"/> <!---->(Deprecated) dsnp.tombstone: Mark content for deletion (v1)<!----></label><label><input type="checkbox" value="5"/> <!---->(Deprecated) dsnp.update: Update an existing post or reply (v1)<!----></label><label><input type="checkbox" value="17"/> <!---->dsnp.broadcast: Create new public content (v2)<!----></label><label><input type="checkbox" value="12"/> <!---->dsnp.dsnp-content-attribute: Create an authenticated attribute set for DSNP content (v1)<!----></label><label><input type="checkbox" value="13"/> <!---->dsnp.ext-content-attribute: Create an authenticated attribute set for content external to DSNP (v1)<!----></label><label><input type="checkbox" value="10"/> <!---->dsnp.private-connections: Update private friendship connections (v1)<!----></label><label><input type="checkbox" value="9"/> <!---->dsnp.private-follows: Update private follow list (v1)<!----></label><label><input type="checkbox" value="15"/> <!---->dsnp.profile-resources: Update user profile information (v1)<!----></label><label><input type="checkbox" value="8"/> <!---->dsnp.public-follows: Update public follow list (v1)<!----></label><label><input type="checkbox" value="4"/> <!---->dsnp.reaction: Public reaction to content (v1)<!----></label><label><input type="checkbox" value="18"/> <!---->dsnp.reply: Public reply to content (v2)<!----></label><label><input type="checkbox" value="16"/> <!---->dsnp.tombstone: Mark content for deletion (v2)<!----></label><label><input type="checkbox" value="19"/> <!---->dsnp.update: Update an existing post or reply (v2)<!----></label><label><input type="checkbox" value="20"/> <!---->dsnp.user-attribute-set: Create an authenticated attribute set for a DSNP User (v2)<!----></label><!--]--> <div><label for="additionalPermissions">Additional Permissions (comma-separated)</label> <input type="text" placeholder="1, 5, 20" id="additionalPermissions" value=""/></div> <div class="my-2 text-sm"><label for="schemaIds">Read Only: List of Schema Ids</label> <input type="text" placeholder="List of Schema Ids" id="schemaIds" value=""/></div></div></fieldset><!----></div> <div class="mb-4"><fieldset><legend>Select Credentials</legend> <div class="checkboxes"><label><input type="checkbox"/> Graph Key (Required for reading private graph)</label> <label><input type="checkbox"/> Verified Email Address</label> <label><input type="checkbox"/> Verified SMS/Phone Number</label></div></fieldset><!----></div> <div class="mb-4"><label for="applicationContext">Application Context URL</label> <input type="url" id="applicationContext" value="" placeholder="https://example.org/my-app-context.json"/></div> <!--[!--><!--]--></form><!----></div> <!--[!--><h2 id="result"><a class="header" href="#result">Result</a></h2> <dl><dt>Login Request Payload and Signature ( <code>signedRequest</code> parameter )</dt> <dd><textarea readonly style="width: 100%; height: 6em; font-size: 1.5rem;"></textarea></dd> <dt>Mainnet/Production URL</dt> <dd><input style="font-size: 1.5rem;" type="text" id="mainnet_generated_url" readonly value="https://www.frequencyaccess.com/siwa/start?signedRequest="/></dd> <dt>Testnet/Staging URL</dt> <dd><input style="font-size: 1.5rem;" type="text" id="testnet_generated_url" readonly value="https://testnet.frequencyaccess.com/siwa/start?signedRequest="/></dd> <dt>Signed Request (JSON)</dt> <dd><details><summary style="cursor: pointer;">Expand</summary> <pre style="overflow:scroll; width: 100%; padding-bottom: 1.5rem;"></pre></details></dd></dl><!--]--><!----><!----></div><!----><!--]--> <!--[!--><!--]--><!--]-->
<script>
{
__sveltekit_k0atpa = {
base: new URL(".", location).pathname.slice(0, -1)
};

const element = document.currentScript.parentElement;

Promise.all([
import("./Generator/_app/immutable/entry/start.CpeorHy4.js"),
import("./Generator/_app/immutable/entry/app.DonfCnB5.js")
]).then(([kit, app]) => {
kit.start(app, element, {
node_ids: [0, 2],
data: [null,null],
form: null,
error: null
});
});
}
</script>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="signed-request-for-authentication-url-signature"><a class="header" href="#signed-request-for-authentication-url-signature">Signed Request for Authentication URL Signature</a></h1>
<p>Most applications skip all of this and just <a href="./Generate.html">generate the login request payload and signature</a>.</p>
<h2 id="step-1-create-the-payload-for-signing"><a class="header" href="#step-1-create-the-payload-for-signing">Step 1: Create the Payload for Signing</a></h2>
<h3 id="parameter-callback"><a class="header" href="#parameter-callback">Parameter: <code>callback</code></a></h3>
<p>When the user has completed the authentication, this is the return URI that will be used.</p>
<p>Appended to the URL will be this parameter:</p>
<ul>
<li><code>authorizationCode</code> Used to retrieve the full response payload</li>
</ul>
<p>The callback url <em>will maintain</em> any other URL parameters included.
For example, if you wish to correlate the original unauthorized session with the authorized session, you can generate a dynamic callback url with a parameter with a random UUIDv4 identifier on each request.</p>
<h3 id="parameter-permissions"><a class="header" href="#parameter-permissions">Parameter: <code>permissions</code></a></h3>
<p>The list of Frequency Schema Ids permissions your application is requesting from the user.</p>
<ul>
<li>See a full list of <a href="./Delegations.html">Available Delegations</a></li>
</ul>
<h3 id="parameter-useridentifieradminurl"><a class="header" href="#parameter-useridentifieradminurl">Parameter: <code>userIdentifierAdminUrl</code></a></h3>
<p>Only used for custom integration situations.</p>
<h2 id="step-2-signing-the-request"><a class="header" href="#step-2-signing-the-request">Step 2: Signing the Request</a></h2>
<p>To ensure that the correct application is requesting the authentication and that the response is only sent to the authorized party, the request is signed.
The signature MUST be from one of the <a href="https://docs.frequency.xyz/Identity/ControlKeys.html">Control Keys</a> of the Frequency Provider.</p>
<h3 id="2a-serialize-the-payload-using-the-scale-codec"><a class="header" href="#2a-serialize-the-payload-using-the-scale-codec">2a: Serialize the payload using the <a href="https://docs.substrate.io/reference/scale-codec/">SCALE Codec</a></a></h3>
<p>SCALE Type (Note: Order matters!)</p>
<pre><code class="language-json">{
  "callback": "String",
  "permissions": "Vec&lt;U16&gt;",
  "userIdentifierAdminUrl": "Option&lt;String&gt;",
}
</code></pre>
<h3 id="2b-wrap-the-payload"><a class="header" href="#2b-wrap-the-payload">2b: Wrap the Payload</a></h3>
<p>So that no payloads can be accidentally used on a chain, the payload is wrapped with a <code>&lt;Bytes&gt;</code> tag.</p>
<p>Byte Arrays Concatenated: <code>[ 60, 66, 121, 116, 101, 115, 62 ] + scale_encoded_payload_bytes + [ 60, 47, 66, 121, 116, 101, 115, 62 ]</code></p>
<h3 id="2c-sign-the-wrapped-payload-bytes"><a class="header" href="#2c-sign-the-wrapped-payload-bytes">2c: Sign the Wrapped Payload Bytes</a></h3>
<p>Sign the serialized payload using Schnorr signatures over ECDSA.</p>
<h3 id="2d-example"><a class="header" href="#2d-example">2d: Example</a></h3>
<p>Remember that SR25519 signatures are non-deterministic, so the payload and encoding will match, but the signature will be different.
This example uses the <code>//Alice</code> seed phrase to generate the signature.</p>
<ul>
<li>Payload: <code>{ "callback": "https://localhost:44181", "permissions": [5, 7, 8, 9, 10] }</code></li>
<li>SCALE Payload (Hex): <code>0x5c68747470733a2f2f6c6f63616c686f73743a34343138311405000700080009000a0000</code></li>
<li>Wrapped Payload (Hex): <code>0x3c42797465733e5c68747470733a2f2f6c6f63616c686f73743a34343138311405000700080009000a00003c2f42797465733e</code></li>
<li>Signing Public Key (SS58 Prefix 90): <code>f6cL4wq1HUNx11TcvdABNf9UNXXoyH47mVUwT59tzSFRW8yDH</code></li>
<li>Signature (Hex): <code>0x9abd3c54e7164e8385627dc692724b9467386acd7b02a13d6187e2c58fd91440d9134781c0410a45812f5532b71f4a34b4a5443ef8d68b5a1956f7f0f81d4286</code></li>
</ul>
<h2 id="step-3-optional-request-credentials-graph-key-email-phone"><a class="header" href="#step-3-optional-request-credentials-graph-key-email-phone">Step 3 (Optional): Request Credentials (Graph Key, Email, Phone)</a></h2>
<p>Frequency Access users can provide verified email or phone/SMS to your application when requested and approved by the user.
This is <em>not</em> required, and best practice is to only make such a request if it is required for the functioning of the application.</p>
<p>The request MUST be wrapped in <code>requestedCredentials</code> which is an array that requires ALL listed credential objects.
Supported Options:</p>
<ul>
<li><code>anyOf</code>: Request for one or more credentials from the list (0+ may return)</li>
</ul>
<pre><code class="language-json">{
  // ...
  "requestedCredentials": [
    {
      "type": "VerifiedGraphKeyCredential",
      "hash": ["bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y"]
    }
    {
      "anyOf": [
        // List of contact credential requests here
        {
          "type": "VerifiedEmailAddressCredential",
          "hash": ["bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi"]
        },
        {
          "type": "VerifiedPhoneNumberCredential",
          "hash": ["bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq"]
        }
      ]
    }
  ]
}
</code></pre>
<ul>
<li>See a full list of <a href="./Credentials.html">Available Credentials</a></li>
</ul>
<h2 id="step-4-recommended-provide-application-context"><a class="header" href="#step-4-recommended-provide-application-context">Step 4 (Recommended): Provide Application Context</a></h2>
<p>To help users understand which application is asking them to sign in, you can provide an <code>applicationContext</code> object that contains the URL of an application context credential.
This is especially important if you want to manage multiple applications under a single provider identity.
Note that any delegations that are granted by the user will apply to all applications for that provider.</p>
<pre><code class="language-json">{
  // ...
  "applicationContext": {
    "url": "https://example.org/myapp/siwf-manifest.json"
  }
}
</code></pre>
<p>The application context credential is a JSON-formatted verifiable credential that MAY be signed by a credential issuer.
If you are integrating with Frequency Access, your application context details will be created as part of the provisioning process.</p>
<p>For detailed information on the credential schema and properties, see the <a href="./DataStructures/All.html#application-context">full specification and example</a>.</p>
<h3 id="example-using-typescriptjavascript"><a class="header" href="#example-using-typescriptjavascript">Example Using TypeScript/JavaScript</a></h3>
<pre><code class="language-typescript">// This is the URI of a key. Usually just a seed phrase, but also supports test accounts such as `//Alice` or `//Bob`
const providerKeyUri: string = getProviderKeyUriSecret();

// The list of Frequency Schemas Ids that you are requesting the user delegate
// See a full reference: https://projectlibertylabs.github.io/siwf/v2/docs/Delegations.html
// This example is for Graph Only
const permissions: number[] = [7, 8, 9, 10];

// List of Credentials
// See a full reference and examples: https://projectlibertylabs.github.io/siwf/v2/docs/Credentials.html
const credentials = [
  {
    anyOf: [siwf.VerifiedEmailAddressCredential, siwf.VerifiedPhoneNumberCredential],
  },
  siwf.VerifiedGraphKeyCredential,
];

// This is a reference to an application context credential
const applicationContext = {
  url: "https://example.org/myapp/context.json",
};

// This is the URI that the user should return to after authenticating
const callbackUri: string = getWebOrApplicationCallbackUri();

// The Encoded Signed Request can remain static if
// It is the same as is generated with the Signed Payload Generation Tool
const encodedSignedRequest = await siwf.generateEncodedSignedRequest(
  providerKeyUri,
  callbackUri,
  permissions,
  credentials,
  applicationContext,
);

// Options with endpoint selection
// Endpoint may be tagged or specified in full
const options = { endpoint: "production" };
// Staging-Testnet Options
// const options = { endpoint: 'staging' };

const authenticationUrl: string = generateAuthenticationUrl(signedRequest, new URLSearchParams({ id: getSessionId() }));
</code></pre>
<h3 id="full-example-request"><a class="header" href="#full-example-request">Full Example Request</a></h3>
<pre><code class="language-json">{
  "requestedSignatures": {
    "publicKey": {
      "encodedValue": "f6cL4wq1HUNx11TcvdABNf9UNXXoyH47mVUwT59tzSFRW8yDH",
      "encoding": "base58",
      "format": "ss58",
      "type": "Sr25519"
    },
    "signature": {
      "algo": "SR25519",
      "encoding": "base16",
      "encodedValue": "0x0407ce814b77861df94d16b3fcb317d37a07abc2a7f9cd7c02cc22529ee7b32d56795f88bd6b4ad106b72b91b6246a783671bcd24cb01aaf0e9316db5e0cd085"
    },
    "payload": {
      "callback": "http://localhost:3000",
      "permissions": [
        5,
        7,
        8,
        9,
        10
      ]
    }
  },
  "requestedCredentials": [
    {
      "type": "VerifiedGraphKeyCredential",
      "hash": [
        "bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y"
      ]
    },
    {
      "anyOf": [
        {
          "type": "VerifiedEmailAddressCredential",
          "hash": [
            "bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi"
          ]
        },
        {
          "type": "VerifiedPhoneNumberCredential",
          "hash": [
            "bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq"
          ]
        }
      ]
    }
  ],
  "applicationContext": {
    "url": "https://example.org/myapp/siwf-manifest.json",
    "hash": [
      "bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y"
    ]
  }
}
</code></pre>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<p>See <a href="./Actions/Start.html">Start</a> for details on how to use the generated signature.</p>
<h3 id="serialization"><a class="header" href="#serialization">Serialization</a></h3>
<ol>
<li>JSON Stringify the <code>SignedRequest</code> object</li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc4648#section-5"><code>base64url</code></a> encode the stringified result</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="credentials"><a class="header" href="#credentials">Credentials</a></h1>
<h2 id="request-structure"><a class="header" href="#request-structure">Request Structure</a></h2>
<p>The request is an array that requires ALL listed credential objects.
Supported Options:</p>
<ul>
<li><code>anyOf</code>: Request for one or more credentials from the list (0+ may return)</li>
</ul>
<h3 id="example-request"><a class="header" href="#example-request">Example Request</a></h3>
<p>This is a common request: one verified contact method and access to the graph encryption key.</p>
<pre><code class="language-json">[
  {
    "type": "VerifiedGraphKeyCredential",
    "hash": ["bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y"]
  },
  {
    "anyOf": [
      {
        "type": "VerifiedEmailAddressCredential",
        "hash": ["bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi"]
      },
      {
        "type": "VerifiedPhoneNumberCredential",
        "hash": ["bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq"]
      }
    ]
  }
]
</code></pre>
<h2 id="available-credentials"><a class="header" href="#available-credentials">Available Credentials</a></h2>
<p>Each request also has a multiformat hash of the schema file to ensure the correct verification document is requested.
Below are the official types and multihashes to use.</p>
<h3 id="graph-key"><a class="header" href="#graph-key">Graph Key</a></h3>
<ul>
<li>URL: <a href="https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json">https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json</a></li>
</ul>
<pre><code class="language-json">{
  "type": "VerifiedGraphKeyCredential",
  "hash": ["bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y"]
}
</code></pre>
<h3 id="email"><a class="header" href="#email">Email</a></h3>
<ul>
<li>URL: <a href="https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json">https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json</a></li>
</ul>
<pre><code class="language-json">{
  "type": "VerifiedEmailAddressCredential",
  "hash": ["bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi"]
}
</code></pre>
<h3 id="phonesms"><a class="header" href="#phonesms">Phone/SMS</a></h3>
<ul>
<li>URL: <a href="https://schemas.frequencyaccess.com/VerifiedPhoneNumberCredential/bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq.json">https://schemas.frequencyaccess.com/VerifiedPhoneNumberCredential/bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq.json</a></li>
</ul>
<pre><code class="language-json">{
  "type": "VerifiedPhoneNumberCredential",
  "hash": ["bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq"]
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="available-delegations"><a class="header" href="#available-delegations">Available Delegations</a></h1>
<p>Staging-Testnet and Production-Mainnet have the same delegation Schema Ids available.</p>
<!---
Generate this table via root with:
npx tsx tools/signed-request-generator/generate-available-delegations.ts
-->
<div class="table-wrapper"><table><thead><tr><th>Short Name and Specification Link</th><th>Description</th><th>Schema Id</th></tr></thead><tbody>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Broadcast.html"><code>dsnp.broadcast@v1</code></a></td><td>(Deprecated) Create new public content</td><td>2</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Broadcast.html"><code>dsnp.broadcast@v2</code></a></td><td>Create new public content</td><td>17</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/DSNPContentAttributeSet.html"><code>dsnp.dsnp-content-attribute@v1</code></a></td><td>Create an authenticated attribute set for DSNP content</td><td>12</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/ExternalContentAttributeSet.html"><code>dsnp.ext-content-attribute@v1</code></a></td><td>Create an authenticated attribute set for content external to DSNP</td><td>13</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/UserData.html"><code>dsnp.private-connections@v1</code></a></td><td>Update private friendship connections</td><td>10</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/UserData.html"><code>dsnp.private-follows@v1</code></a></td><td>Update private follow list</td><td>9</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/UserData.html"><code>dsnp.profile-resources@v1</code></a></td><td>Update user profile information</td><td>15</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Profile.html"><code>dsnp.profile@v1</code></a></td><td>(Deprecated) Update profile information</td><td>6</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/UserData.html"><code>dsnp.public-follows@v1</code></a></td><td>Update public follow list</td><td>8</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Reaction.html"><code>dsnp.reaction@v1</code></a></td><td>Public reaction to content</td><td>4</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Reply.html"><code>dsnp.reply@v1</code></a></td><td>(Deprecated) Public reply to content</td><td>3</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Reply.html"><code>dsnp.reply@v2</code></a></td><td>Public reply to content</td><td>18</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Tombstone.html"><code>dsnp.tombstone@v1</code></a></td><td>(Deprecated) Mark content for deletion</td><td>1</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Tombstone.html"><code>dsnp.tombstone@v2</code></a></td><td>Mark content for deletion</td><td>16</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Update.html"><code>dsnp.update@v1</code></a></td><td>(Deprecated) Update an existing post or reply</td><td>5</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/Update.html"><code>dsnp.update@v2</code></a></td><td>Update an existing post or reply</td><td>19</td></tr>
<tr><td><a href="https://spec.dsnp.org/DSNP/Types/UserAttributeSet.html"><code>dsnp.user-attribute-set@v2</code></a></td><td>Create an authenticated attribute set for a DSNP User</td><td>20</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="possible-payloads"><a class="header" href="#possible-payloads">Possible Payloads</a></h1>
<p>Each response may have one or more of the following signed payloads.</p>
<h2 id="login-1"><a class="header" href="#login-1">Login</a></h2>
<p>The signature is generated by signing the UTF-8 bytes of <code>payload.message</code> using <code>SR25519</code>.</p>
<p>See <a href="./Actions/Response.html#login">Response Payloads: Login</a> for more details.</p>
<h3 id="example-2"><a class="header" href="#example-2">Example</a></h3>
<p>Example is signed using <code>f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ</code> which is the SS58 (Prefix 90) public key from the seed phrase <code>//Bob</code>.</p>
<pre><code class="language-json">{
  "signature": {
    "algo": "SR25519",
    "encoding": "base16",
    "encodedValue": "0x84a4e03344b07d64087ebdf47b2c8c679aa7de78179689988992609f1b83c34f6086c7de99ef41c5325cce64d148624e716c605d355f22d1281f6d23f546f584"
  },
  "type": "login",
  "payload": {
    "message": "localhost wants you to sign in with your Frequency account:\nf6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ\n\n\n\nURI: https://testnet.frequencyaccess.com/signin/confirm\nNonce: N6rLwqyz34oUxJEXJ\nIssued At: 2024-03-05T23:18:03.041Z\nExpiration Time: 2060-03-05T23:23:03.041Z"
  }
}
</code></pre>
<h2 id="add-provider"><a class="header" href="#add-provider">Add Provider</a></h2>
<p>This payload follows the <a href="https://frequency-chain.github.io/frequency/pallet_msa/types/struct.AddProvider.html"><code>AddProvider</code></a> type from Frequency.
It has the same payload for two different endpoint extrinsics: <code>createSponsoredAccountWithDelegation</code> used for creating a new MSA on chain and <code>grantDelegation</code> which is used to grant a new provider permissions on an existing MSA.</p>
<p>The signature is generated by signing the <a href="https://docs.substrate.io/reference/scale-codec/">SCALE-encoded payload</a> using <code>SR25519</code>.</p>
<h3 id="example-3"><a class="header" href="#example-3">Example</a></h3>
<p>Example is signed using <code>f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ</code> which is the SS58 (Prefix 90) public key from the seed phrase <code>//Bob</code>.</p>
<pre><code class="language-json">{
  "signature": {
    "algo": "SR25519",
    "encoding": "base16",
    "encodedValue": "0x94156d570b29e9c4e3a04eefbff56439f40de7fb6bdba1ca31e9017b55e5e773f747d0ab4f0fc2b44ca903aa8fb641f227fac395e74bb1d837d07cfa70fa1e80"
  },
  "endpoint": {
    "pallet": "msa",
    "extrinsic": "grantDelegation"
  },
  "type": "addProvider",
  "payload": {
    "authorizedMsaId": 1,
    "schemaIds": [
      5,
      7,
      8,
      9,
      10
    ],
    "expiration": 24
  }
}
</code></pre>
<h3 id="scale-payload-type"><a class="header" href="#scale-payload-type">SCALE Payload Type</a></h3>
<pre><code class="language-json">{
  authorizedMsaId: 'u64',
  schemaIds: 'Vec&lt;u16&gt;',
  expiration: 'u32',
}
</code></pre>
<h2 id="claim-handle"><a class="header" href="#claim-handle">Claim Handle</a></h2>
<p>This payload follows the <a href="https://frequency-chain.github.io/frequency/common_primitives/handles/struct.ClaimHandlePayload.html"><code>ClaimHandlePayload</code></a> type from Frequency.</p>
<p>The signature is generated by signing the <a href="https://docs.substrate.io/reference/scale-codec/">SCALE-encoded payload</a> using <code>SR25519</code>.</p>
<h3 id="example-4"><a class="header" href="#example-4">Example</a></h3>
<p>Example is signed using <code>f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ</code> which is the SS58 (Prefix 90) public key from the seed phrase <code>//Bob</code>.</p>
<pre><code class="language-json">{
  "signature": {
    "algo": "SR25519",
    "encoding": "base16",
    "encodedValue": "0xc8c7587ef80b6bd64295d63b69f97196a9a0b635bd8f1974156d7e3c7206134bb9838d29978a2f91c18a6592aff180f2314db7528b6aac796f0073d758406e81"
  },
  "endpoint": {
    "pallet": "handles",
    "extrinsic": "claimHandle"
  },
  "type": "claimHandle",
  "payload": {
    "baseHandle": "ExampleHandle",
    "expiration": 24
  }
}
</code></pre>
<h3 id="scale-payload-type-1"><a class="header" href="#scale-payload-type-1">SCALE Payload Type</a></h3>
<pre><code class="language-json">{
  baseHandle: 'Bytes',
  expiration: 'u32',
}
</code></pre>
<h2 id="user-item-actions"><a class="header" href="#user-item-actions">User Item Actions</a></h2>
<p>This payload follows the <a href="https://frequency-chain.github.io/frequency/pallet_stateful_storage/types/struct.ItemizedSignaturePayloadV2.html"><code>ItemizedSignaturePayloadV2</code></a> type from Frequency.</p>
<p>The signature is generated by signing the <a href="https://docs.substrate.io/reference/scale-codec/">SCALE-encoded payload</a> using <code>SR25519</code>.</p>
<h3 id="example-5"><a class="header" href="#example-5">Example</a></h3>
<p>Example is signed using <code>f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ</code> which is the SS58 (Prefix 90) public key from the seed phrase <code>//Bob</code>.</p>
<pre><code class="language-json">{
  "signature": {
    "algo": "SR25519",
    "encoding": "base16",
    "encodedValue": "0x86bdd46a5f91ed3f259374f5856fdc48ee00b8eced10eecd05af8d7637c51d17df6252f617feacbce1cf91cc57ca036c69773ab9b0c31d6843344704b4fb898d"
  },
  "endpoint": {
    "pallet": "statefulStorage",
    "extrinsic": "applyItemActionsWithSignatureV2"
  },
  "type": "itemActions",
  "payload": {
    "schemaId": 7,
    "targetHash": 0,
    "expiration": 20,
    "actions": [
      {
        "type": "addItem",
        "payloadHex": "0x40eea1e39d2f154584c4b1ca8f228bb49ae5a14786ed63c90025e755f16bd58d37"
      }
    ]
  }
}
</code></pre>
<h3 id="scale-payload-types"><a class="header" href="#scale-payload-types">SCALE Payload Types</a></h3>
<pre><code class="language-json">{
  PalletStatefulStorageItemActionEnumAdd: {
    data: 'Bytes',
  },
  PalletStatefulStorageItemActionEnumDelete: {
    index: 'u16',
  },
  PalletStatefulStorageItemAction: {
    _enum: {
      Add: '&lt;PalletStatefulStorageItemActionEnumAdd&gt;',
      Delete: '&lt;PalletStatefulStorageItemActionEnumDelete&gt;',
    },
  },
  PalletStatefulStorageItemizedSignaturePayloadV2: {
    schemaId: 'Compact&lt;u16&gt;',
    targetHash: 'Compact&lt;u32&gt;',
    expiration: 'u32',
    actions: 'Vec&lt;PalletStatefulStorageItemAction&gt;',
  },
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-structure-reference"><a class="header" href="#data-structure-reference">Data Structure Reference</a></h1>
<h2 id="request--response-from-siwf"><a class="header" href="#request--response-from-siwf">Request / Response from SIWF</a></h2>
<h3 id="request"><a class="header" href="#request">Request</a></h3>
<pre><code class="language-json">{
  "signedRequest": "eyJyZXF1ZXN0ZWRTaWduYXR1cmVzIjp7InB1YmxpY0tleSI6eyJlbmNvZGVkVmFsdWUiOiJmNmNMNHdxMUhVTngxMVRjdmRBQk5mOVVOWFhveUg0N21WVXdUNTl0elNGUlc4eURIIiwiZW5jb2RpbmciOiJiYXNlNTgiLCJmb3JtYXQiOiJzczU4IiwidHlwZSI6IlNyMjU1MTkifSwic2lnbmF0dXJlIjp7ImFsZ28iOiJTUjI1NTE5IiwiZW5jb2RpbmciOiJiYXNlMTYiLCJlbmNvZGVkVmFsdWUiOiIweDk2MGYxOTVkYzFmOTFiZjcxYzBiMzUyMzE1MGFlMzc0NzFiZWRlMDdhMDAzOTA5NjQ3Y2NmMDQwYWNkNWNkMDRlYTQ4NzBiZDEyNGNhZmEyZGViNTliMGUzNzhjYjE5ZmJjNmFmNjAxYjc1NTU5ZmFhYjdiNzY4ZGU4MWEwOTgzIn0sInBheWxvYWQiOnsiY2FsbGJhY2siOiJodHRwOi8vbG9jYWxob3N0OjMwMDAiLCJwZXJtaXNzaW9ucyI6WzUsNyw4LDksMTBdfX0sInJlcXVlc3RlZENyZWRlbnRpYWxzIjpbeyJ0eXBlIjoiVmVyaWZpZWRHcmFwaEtleUNyZWRlbnRpYWwiLCJoYXNoIjpbImJjaXFtZHZteGQ1NHp2ZTVraWZ5Y2dzZHRvYWhzNWVjZjRoYWwydHMzZWV4a2dvY3ljNW9jYTJ5Il19LHsiYW55T2YiOlt7InR5cGUiOiJWZXJpZmllZEVtYWlsQWRkcmVzc0NyZWRlbnRpYWwiLCJoYXNoIjpbImJjaXFlNHFvY3poZnRpY2k0ZHpmdmZiZWw3Zm80aDRzcjVncmNvM29vdnd5azZ5NHluZjQ0dHNpIl19LHsidHlwZSI6IlZlcmlmaWVkUGhvbmVOdW1iZXJDcmVkZW50aWFsIiwiaGFzaCI6WyJiY2lxanNwbmJ3cGMzd2p4NGZld2NlazVkYXlzZGpwYmY1eGppbXo1d251NXVqN2UzdnUydXducSJdfV19XX0",
  "mode": "dark"
}
</code></pre>
<h3 id="request-url"><a class="header" href="#request-url">Request URL</a></h3>
<pre><code class="language-json">"https://testnet.frequencyaccess.com/siwa/start?signedRequest=eyJyZXF1ZXN0ZWRTaWduYXR1cmVzIjp7InB1YmxpY0tleSI6eyJlbmNvZGVkVmFsdWUiOiJmNmNMNHdxMUhVTngxMVRjdmRBQk5mOVVOWFhveUg0N21WVXdUNTl0elNGUlc4eURIIiwiZW5jb2RpbmciOiJiYXNlNTgiLCJmb3JtYXQiOiJzczU4IiwidHlwZSI6IlNyMjU1MTkifSwic2lnbmF0dXJlIjp7ImFsZ28iOiJTUjI1NTE5IiwiZW5jb2RpbmciOiJiYXNlMTYiLCJlbmNvZGVkVmFsdWUiOiIweDk2MGYxOTVkYzFmOTFiZjcxYzBiMzUyMzE1MGFlMzc0NzFiZWRlMDdhMDAzOTA5NjQ3Y2NmMDQwYWNkNWNkMDRlYTQ4NzBiZDEyNGNhZmEyZGViNTliMGUzNzhjYjE5ZmJjNmFmNjAxYjc1NTU5ZmFhYjdiNzY4ZGU4MWEwOTgzIn0sInBheWxvYWQiOnsiY2FsbGJhY2siOiJodHRwOi8vbG9jYWxob3N0OjMwMDAiLCJwZXJtaXNzaW9ucyI6WzUsNyw4LDksMTBdfX0sInJlcXVlc3RlZENyZWRlbnRpYWxzIjpbeyJ0eXBlIjoiVmVyaWZpZWRHcmFwaEtleUNyZWRlbnRpYWwiLCJoYXNoIjpbImJjaXFtZHZteGQ1NHp2ZTVraWZ5Y2dzZHRvYWhzNWVjZjRoYWwydHMzZWV4a2dvY3ljNW9jYTJ5Il19LHsiYW55T2YiOlt7InR5cGUiOiJWZXJpZmllZEVtYWlsQWRkcmVzc0NyZWRlbnRpYWwiLCJoYXNoIjpbImJjaXFlNHFvY3poZnRpY2k0ZHpmdmZiZWw3Zm80aDRzcjVncmNvM29vdnd5azZ5NHluZjQ0dHNpIl19LHsidHlwZSI6IlZlcmlmaWVkUGhvbmVOdW1iZXJDcmVkZW50aWFsIiwiaGFzaCI6WyJiY2lxanNwbmJ3cGMzd2p4NGZld2NlazVkYXlzZGpwYmY1eGppbXo1d251NXVqN2UzdnUydXducSJdfV19XX0&amp;mode=dark"
</code></pre>
<h3 id="signed-request"><a class="header" href="#signed-request">Signed Request</a></h3>
<p>This is JSON stringified and then <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-5"><code>base64url</code></a> encoded for the Request <code>signedRequest</code> value.</p>
<pre><code class="language-json">{
  "requestedSignatures": {
    "publicKey": {
      "encodedValue": "f6cL4wq1HUNx11TcvdABNf9UNXXoyH47mVUwT59tzSFRW8yDH",
      "encoding": "base58",
      "format": "ss58",
      "type": "Sr25519"
    },
    "signature": {
      "algo": "SR25519",
      "encoding": "base16",
      "encodedValue": "0x0407ce814b77861df94d16b3fcb317d37a07abc2a7f9cd7c02cc22529ee7b32d56795f88bd6b4ad106b72b91b6246a783671bcd24cb01aaf0e9316db5e0cd085"
    },
    "payload": {
      "callback": "http://localhost:3000",
      "permissions": [
        5,
        7,
        8,
        9,
        10
      ]
    }
  },
  "requestedCredentials": [
    {
      "type": "VerifiedGraphKeyCredential",
      "hash": [
        "bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y"
      ]
    },
    {
      "anyOf": [
        {
          "type": "VerifiedEmailAddressCredential",
          "hash": [
            "bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi"
          ]
        },
        {
          "type": "VerifiedPhoneNumberCredential",
          "hash": [
            "bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq"
          ]
        }
      ]
    }
  ],
  "applicationContext": {
    "url": "https://example.org/myapp/siwf-manifest.json",
    "hash": [
      "bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y"
    ]
  }
}
</code></pre>
<h3 id="new-frequency-user-response-1"><a class="header" href="#new-frequency-user-response-1">New Frequency User Response</a></h3>
<pre><code class="language-json">{
  "userPublicKey": {
    "encodedValue": "f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ",
    "encoding": "base58",
    "format": "ss58",
    "type": "Sr25519"
  },
  "payloads": [
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0x1a27cb6d79b508e1ffc8d6ae70af78d5b3561cdc426124a06f230d7ce70e757e1947dd1bac8f9e817c30676a5fa6b06510bae1201b698b044ff0660c60f18c8a"
      },
      "endpoint": {
        "pallet": "msa",
        "extrinsic": "createSponsoredAccountWithDelegation"
      },
      "type": "addProvider",
      "payload": {
        "authorizedMsaId": 1,
        "schemaIds": [
          5,
          7,
          8,
          9,
          10
        ],
        "expiration": 24
      }
    },
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0x9eb338773b386ded2e3731ba68ba734c80408b3ad24f92ed3c60342d374a32293851fa8e41d722c72a5a4e765a9e401c68570a8c666ab678e4e5d94aa6825d85"
      },
      "endpoint": {
        "pallet": "statefulStorage",
        "extrinsic": "applyItemActionsWithSignatureV2"
      },
      "type": "itemActions",
      "payload": {
        "schemaId": 7,
        "targetHash": 0,
        "expiration": 20,
        "actions": [
          {
            "type": "addItem",
            "payloadHex": "0x40eea1e39d2f154584c4b1ca8f228bb49ae5a14786ed63c90025e755f16bd58d37"
          }
        ]
      }
    },
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0xb004140fd8ba3395cf5fcef49df8765d90023c293fde4eaf2e932cc24f74fc51b006c0bebcf31d85565648b4881fa22115e0051a3bdb95ab5bf7f37ac66f798f"
      },
      "endpoint": {
        "pallet": "handles",
        "extrinsic": "claimHandle"
      },
      "type": "claimHandle",
      "payload": {
        "baseHandle": "ExampleHandle",
        "expiration": 24
      }
    }
  ],
  "credentials": [
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedEmailAddressCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:web:frequencyaccess.com",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "emailAddress": "john.doe@example.com",
        "lastVerified": "2024-08-21T21:27:59.309+0000"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z4jArnPwuwYxLnbBirLanpkcyBpmQwmyn5f3PdTYnxhpy48qpgvHHav6warjizjvtLMg6j3FK3BqbR2nuyT2UTSWC"
      }
    },
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedGraphKeyCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "encodedPublicKeyValue": "0xb5032900293f1c9e5822fd9c120b253cb4a4dfe94c214e688e01f32db9eedf17",
        "encodedPrivateKeyValue": "0xd0910c853563723253c4ed105c08614fc8aaaf1b0871375520d72251496e8d87",
        "encoding": "base16",
        "format": "bare",
        "type": "X25519",
        "keyType": "dsnp.public-key-key-agreement"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:key:z6MktZ15TNtrJCW2gDLFjtjmxEdhCadNCaDizWABYfneMqhA",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z2HHWwtWggZfvGqNUk4S5AAbDGqZRFXjpMYAsXXmEksGxTk4DnnkN3upCiL1mhgwHNLkxY3s8YqNyYnmpuvUke7jF"
      }
    }
  ]
}
</code></pre>
<h3 id="new-applicationdelegation-response-1"><a class="header" href="#new-applicationdelegation-response-1">New Application/Delegation Response</a></h3>
<pre><code class="language-json">{
  "userPublicKey": {
    "encodedValue": "f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ",
    "encoding": "base58",
    "format": "ss58",
    "type": "Sr25519"
  },
  "payloads": [
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0xbac399831b9e3ad464a16e62ad1252cc8344a2c52f80252b2aa450a06ae2362f6f4afcaca791a81f28eaa99080e2654bdbf1071a276213242fc153cca43cfa8e"
      },
      "endpoint": {
        "pallet": "msa",
        "extrinsic": "grantDelegation"
      },
      "type": "addProvider",
      "payload": {
        "authorizedMsaId": 1,
        "schemaIds": [
          5,
          7,
          8,
          9,
          10
        ],
        "expiration": 24
      }
    }
  ],
  "credentials": [
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedEmailAddressCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:web:frequencyaccess.com",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "emailAddress": "john.doe@example.com",
        "lastVerified": "2024-08-21T21:27:59.309+0000"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z4jArnPwuwYxLnbBirLanpkcyBpmQwmyn5f3PdTYnxhpy48qpgvHHav6warjizjvtLMg6j3FK3BqbR2nuyT2UTSWC"
      }
    },
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedGraphKeyCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "encodedPublicKeyValue": "0xb5032900293f1c9e5822fd9c120b253cb4a4dfe94c214e688e01f32db9eedf17",
        "encodedPrivateKeyValue": "0xd0910c853563723253c4ed105c08614fc8aaaf1b0871375520d72251496e8d87",
        "encoding": "base16",
        "format": "bare",
        "type": "X25519",
        "keyType": "dsnp.public-key-key-agreement"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:key:z6MktZ15TNtrJCW2gDLFjtjmxEdhCadNCaDizWABYfneMqhA",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z2HHWwtWggZfvGqNUk4S5AAbDGqZRFXjpMYAsXXmEksGxTk4DnnkN3upCiL1mhgwHNLkxY3s8YqNyYnmpuvUke7jF"
      }
    }
  ]
}
</code></pre>
<h3 id="login-only-response-1"><a class="header" href="#login-only-response-1">Login Only Response</a></h3>
<pre><code class="language-json">{
  "userPublicKey": {
    "encodedValue": "f6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ",
    "encoding": "base58",
    "format": "ss58",
    "type": "Sr25519"
  },
  "payloads": [
    {
      "signature": {
        "algo": "SR25519",
        "encoding": "base16",
        "encodedValue": "0xe261698297111834e68b4152bf1f89819e886b6528f6fff45715f7781d0f1e7dc4007ccfed1e85b8c603c0fea2f7abf22bfe6336869ad21f11a09a114452c680"
      },
      "type": "login",
      "payload": {
        "message": "your-app.com wants you to sign in with your Frequency account:\nf6akufkq9Lex6rT8RCEDRuoZQRgo5pWiRzeo81nmKNGWGNJdJ\n\n\n\nURI: https://your-app.com/signin/callback\nNonce: N6rLwqyz34oUxJEXJ\nIssued At: 2024-10-29T19:17:27.077Z\nExpiration Time: 2060-03-05T23:23:03.041Z"
      }
    }
  ],
  "credentials": [
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedEmailAddressCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:web:frequencyaccess.com",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "emailAddress": "john.doe@example.com",
        "lastVerified": "2024-08-21T21:27:59.309+0000"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z4jArnPwuwYxLnbBirLanpkcyBpmQwmyn5f3PdTYnxhpy48qpgvHHav6warjizjvtLMg6j3FK3BqbR2nuyT2UTSWC"
      }
    },
    {
      "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/undefined-terms/v2"
      ],
      "type": [
        "VerifiedGraphKeyCredential",
        "VerifiableCredential"
      ],
      "issuer": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
      "validFrom": "2024-08-21T21:28:08.289+0000",
      "credentialSchema": {
        "type": "JsonSchema",
        "id": "https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json"
      },
      "credentialSubject": {
        "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
        "encodedPublicKeyValue": "0xb5032900293f1c9e5822fd9c120b253cb4a4dfe94c214e688e01f32db9eedf17",
        "encodedPrivateKeyValue": "0xd0910c853563723253c4ed105c08614fc8aaaf1b0871375520d72251496e8d87",
        "encoding": "base16",
        "format": "bare",
        "type": "X25519",
        "keyType": "dsnp.public-key-key-agreement"
      },
      "proof": {
        "type": "DataIntegrityProof",
        "verificationMethod": "did:key:z6MktZ15TNtrJCW2gDLFjtjmxEdhCadNCaDizWABYfneMqhA",
        "cryptosuite": "eddsa-rdfc-2022",
        "proofPurpose": "assertionMethod",
        "proofValue": "z2HHWwtWggZfvGqNUk4S5AAbDGqZRFXjpMYAsXXmEksGxTk4DnnkN3upCiL1mhgwHNLkxY3s8YqNyYnmpuvUke7jF"
      }
    }
  ]
}
</code></pre>
<h2 id="verified-user-data"><a class="header" href="#verified-user-data">Verified User Data</a></h2>
<h3 id="graph-key-1"><a class="header" href="#graph-key-1">Graph Key</a></h3>
<pre><code class="language-json">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/undefined-terms/v2"
  ],
  "type": [
    "VerifiedGraphKeyCredential",
    "VerifiableCredential"
  ],
  "issuer": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
  "validFrom": "2024-08-21T21:28:08.289+0000",
  "credentialSchema": {
    "type": "JsonSchema",
    "id": "https://schemas.frequencyaccess.com/VerifiedGraphKeyCredential/bciqmdvmxd54zve5kifycgsdtoahs5ecf4hal2ts3eexkgocyc5oca2y.json"
  },
  "credentialSubject": {
    "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
    "encodedPublicKeyValue": "0xb5032900293f1c9e5822fd9c120b253cb4a4dfe94c214e688e01f32db9eedf17",
    "encodedPrivateKeyValue": "0xd0910c853563723253c4ed105c08614fc8aaaf1b0871375520d72251496e8d87",
    "encoding": "base16",
    "format": "bare",
    "type": "X25519",
    "keyType": "dsnp.public-key-key-agreement"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "verificationMethod": "did:key:z6MktZ15TNtrJCW2gDLFjtjmxEdhCadNCaDizWABYfneMqhA",
    "cryptosuite": "eddsa-rdfc-2022",
    "proofPurpose": "assertionMethod",
    "proofValue": "z2HHWwtWggZfvGqNUk4S5AAbDGqZRFXjpMYAsXXmEksGxTk4DnnkN3upCiL1mhgwHNLkxY3s8YqNyYnmpuvUke7jF"
  }
}
</code></pre>
<h2 id="verified-contact-credentials"><a class="header" href="#verified-contact-credentials">Verified Contact Credentials</a></h2>
<h3 id="email-1"><a class="header" href="#email-1">Email</a></h3>
<pre><code class="language-json">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/undefined-terms/v2"
  ],
  "type": [
    "VerifiedEmailAddressCredential",
    "VerifiableCredential"
  ],
  "issuer": "did:web:frequencyaccess.com",
  "validFrom": "2024-08-21T21:28:08.289+0000",
  "credentialSchema": {
    "type": "JsonSchema",
    "id": "https://schemas.frequencyaccess.com/VerifiedEmailAddressCredential/bciqe4qoczhftici4dzfvfbel7fo4h4sr5grco3oovwyk6y4ynf44tsi.json"
  },
  "credentialSubject": {
    "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
    "emailAddress": "john.doe@example.com",
    "lastVerified": "2024-08-21T21:27:59.309+0000"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
    "cryptosuite": "eddsa-rdfc-2022",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4jArnPwuwYxLnbBirLanpkcyBpmQwmyn5f3PdTYnxhpy48qpgvHHav6warjizjvtLMg6j3FK3BqbR2nuyT2UTSWC"
  }
}
</code></pre>
<h3 id="smsphone"><a class="header" href="#smsphone">SMS/Phone</a></h3>
<pre><code class="language-json">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/undefined-terms/v2"
  ],
  "type": [
    "VerifiedPhoneNumberCredential",
    "VerifiableCredential"
  ],
  "issuer": "did:web:frequencyaccess.com",
  "validFrom": "2024-08-21T21:28:08.289+0000",
  "credentialSchema": {
    "type": "JsonSchema",
    "id": "https://schemas.frequencyaccess.com/VerifiedPhoneNumberCredential/bciqjspnbwpc3wjx4fewcek5daysdjpbf5xjimz5wnu5uj7e3vu2uwnq.json"
  },
  "credentialSubject": {
    "id": "did:key:z6QNucQV4AF1XMQV4kngbmnBHwYa6mVswPEGrkFrUayhttT1",
    "phoneNumber": "+01-234-867-5309",
    "lastVerified": "2024-08-21T21:27:59.309+0000"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "verificationMethod": "did:web:frequencyaccess.com#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
    "cryptosuite": "eddsa-rdfc-2022",
    "proofPurpose": "assertionMethod",
    "proofValue": "z5sJ2CjHX1wwgzfFGoZNocxeFKd2ffpo5TVgUvdaSkYq1M6gF7UjpYfePo97QoZgmiWdgPAWPjxFvGBysaxHV8DZ4"
  }
}
</code></pre>
<h2 id="context-data"><a class="header" href="#context-data">Context Data</a></h2>
<h3 id="application-context-credential"><a class="header" href="#application-context-credential">Application Context Credential</a></h3>
<h4 id="schema"><a class="header" href="#schema">Schema</a></h4>
<p>An application context credential MUST be a W3C Verifiable Credential document containing information about the application requesting user sign in.</p>
<p>The <code>type</code> array for the credential should begin with the string <code>"ApplicationContextCredential"</code>.</p>
<p>The <code>credentialSchema</code> field should contain an object with the following fields:</p>
<ul>
<li><code>type</code>: MUST be <code>JsonSchema</code></li>
<li><code>id</code>: MUST be the URL of the published application context credential schema. The latest version is <a href="https://schemas.frequencyaccess.com/ApplicationContextCredential/bciqe2bsnuaqg7zy3gqjmwha2q5h2bybvr6log2jsb5kjn2hos6irrlq.json"><code>https://schemas.frequencyaccess.com/ApplicationContextCredential/bciqe2bsnuaqg7zy3gqjmwha2q5h2bybvr6log2jsb5kjn2hos6irrlq.json</code></a>.</li>
</ul>
<p>The <code>credentialSubject</code> field should contain an object with the following fields:</p>
<ul>
<li><code>id</code>: Your provider identifier, expressed as a DID.</li>
<li><code>application</code>: A JSON object containing the following keys:
<ul>
<li><code>name</code>: A map of one or more language tags to human-readable string values. Language tags should follow <a href="https://www.rfc-editor.org/rfc/rfc5646.html">BCP-47/RFC-5646</a> (as used in the HTTP <code>Content-Language</code> header). A content language key of <code>"*"</code> indicates a wildcard or default value, as in HTTP.</li>
<li><code>logo</code>: A map of one or more language tags (as above) to objects containing a <code>url</code> property. The URL should resolve to an image in the PNG format. The recommended image size is 250 x 100 pixels.</li>
</ul>
</li>
</ul>
<p>The credential SHOULD be signed by a trusted <code>issuer</code>.
The issuer MAY be the provider's control key, expressed in <code>did:key</code> syntax.</p>
<h4 id="example-6"><a class="header" href="#example-6">Example</a></h4>
<p>This application context credential describes a hypothetical app called "My Social App".</p>
<pre><code class="language-json">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/undefined-terms/v2"
  ],
  "type": [
    "ApplicationContextCredential",
    "VerifiableCredential"
  ],
  "issuer": "did:key:z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
  "validFrom": "2025-02-12T21:28:08.289+0000",
  "credentialSchema": {
    "type": "JsonSchema",
    "id": "https://schemas.frequencyaccess.com/ApplicationContextCredential/bciqe2bsnuaqg7zy3gqjmwha2q5h2bybvr6log2jsb5kjn2hos6irrlq.json"
  },
  "credentialSubject": {
    "id": "did:key:z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
    "application": {
      "name": {
        "en": "My Social App",
        "es": "Mi Aplicación Social"
      },
      "logo": {
        "*": {
          "url": "https://example.org/logos/my-social-app.png"
        }
      }
    }
  },
  "proof": {
    "type": "DataIntegrityProof",
    "verificationMethod": "did:key:z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD#z6MkofWExWkUvTZeXb9TmLta5mBT6Qtj58es5Fqg1L5BCWQD",
    "cryptosuite": "eddsa-rdfc-2022",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4jArnPwuwYxLnbBirLanpkcyBpmQwmyn5f3PdTYnxhpy48qpgvHHav6warjizjvtLMg6j3FK3BqbR2nuyT2UTSWC"
  }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sign-in-with-frequency-siwf-sdk-integration-guide"><a class="header" href="#sign-in-with-frequency-siwf-sdk-integration-guide">Sign In With Frequency (SIWF) SDK Integration Guide</a></h1>
<p>The SIWF SDK provides a seamless authentication experience for your applications.
These guides will walk you through integrating the SIWF SDK into your <strong>iOS</strong> or <strong>Android</strong> app.</p>
<h3 id="platform-specific-sdk-guides"><a class="header" href="#platform-specific-sdk-guides">Platform-Specific SDK Guides</a></h3>
<ul>
<li><a href="SDK/Android.html">Android</a></li>
<li><a href="SDK/iOS.html">iOS</a></li>
<li><a href="SDK/Web.html">Web</a></li>
</ul>
<hr />
<h2 id="general-overview"><a class="header" href="#general-overview">General Overview</a></h2>
<h3 id="1-installation"><a class="header" href="#1-installation">1. Installation</a></h3>
<p>Add the platform-specific package to your project.</p>
<h3 id="2-displaying-the-siwf-button"><a class="header" href="#2-displaying-the-siwf-button">2. Displaying the SIWF Button</a></h3>
<p>SIWF Button creation will require the <a href="SDK/../Actions/Start.html#step-1-generate-the-signed-request-payload">Signed Request Payload</a> in either <code>base64url</code> encoded or structured form.
You may also specify other options such as the button style (light/dark) and the network (Mainnet/Testnet) to use.</p>
<h3 id="3-handling-authorization-callbacks"><a class="header" href="#3-handling-authorization-callbacks">3. Handling Authorization Callbacks</a></h3>
<p>You will need to create a redirect handler to receive information from the Authorization (i.e. the redirect URL provided to the Signed Request Payload).
This redirect handler will receive information once the authorization is complete, which may then be sent and processed by your system’s backend to initiate the session.</p>
<p>See platform-specific details in the <a href="SDK/Android.html">Android</a> or <a href="SDK/iOS.html">iOS</a> sections for instructions for creating the callback handler.
<a href="SDK/Web.html">Web</a> requires your own callback processing to extract the <code>authorizationCode</code> from the URL parameters.</p>
<h3 id="4-process-authorization-code"><a class="header" href="#4-process-authorization-code">4. Process Authorization Code</a></h3>
<p>On your backend service, process the authorization code and start your session.
The <a href="https://projectlibertylabs.github.io/gateway/GettingStarted/SSO.html">Frequency Gateway Account Service</a> supports directing sending the result from the authorization process for processing.</p>
<p>Resources:</p>
<ul>
<li><a href="https://projectlibertylabs.github.io/siwf/v2/docs/Actions/Response.html">SIWF Documentation on Processing a Result</a></li>
<li><a href="https://projectlibertylabs.github.io/gateway/GettingStarted/SSO.html">Frequency Gateway SSO Tutorial</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-siwf-sdk"><a class="header" href="#android-siwf-sdk">Android SIWF SDK</a></h1>
<h2 id="quick-reference-2"><a class="header" href="#quick-reference-2">Quick Reference</a></h2>
<ul>
<li><a href="https://github.com/ProjectLibertyLabs/siwf-sdk-android">SIWF Android SDK Source Code + Demo App</a></li>
<li><a href="https://central.sonatype.com/artifact/io.projectliberty/siwf">Maven Central Package <code>io.projectliberty:siwf</code></a></li>
</ul>
<h2 id="1-installation-1"><a class="header" href="#1-installation-1">1. Installation</a></h2>
<h3 id="requirements"><a class="header" href="#requirements">Requirements</a></h3>
<ul>
<li>Android API level <strong>24</strong> or later</li>
<li>Java <strong>11+</strong></li>
</ul>
<h3 id="installing-the-siwf-sdk"><a class="header" href="#installing-the-siwf-sdk">Installing the SIWF SDK</a></h3>
<p>To install the SIWF SDK via <strong>Gradle</strong>, add the following to your <code>build.gradle</code> file:</p>
<pre><code class="language-gradle">dependencies {
    implementation 'io.projectliberty:siwf:1.0.0'
}
</code></pre>
<p><a href="https://central.sonatype.com/artifact/io.projectliberty/siwf">Maven Central Package Page</a></p>
<h2 id="2-displaying-the-siwf-button-1"><a class="header" href="#2-displaying-the-siwf-button-1">2. Displaying the SIWF Button</a></h2>
<p>To create a SIWF Button in your Android app, use:</p>
<pre><code class="language-kotlin">import io.projectliberty.siwf.Siwf
import io.projectliberty.models.SiwfButtonMode

Siwf.CreateSignInButton(
    mode = SiwfButtonMode.PRIMARY,
    authRequest = authRequest
)
</code></pre>
<p><code>authRequest</code> requires the <a href="SDK/../Actions/Start.html#step-1-generate-the-signed-request-payload">Signed Request Payload</a> in either <code>base64url</code> encoded or structured form.</p>
<h2 id="3-handling-authorization-callbacks-1"><a class="header" href="#3-handling-authorization-callbacks-1">3. Handling Authorization Callbacks</a></h2>
<p>Update your <code>AndroidManifest.xml</code> with your own intent filters for authentication callbacks.
Then, use a <code>BroadcastReceiver()</code> to receive the authorization code with <code>AuthConstants.AUTH_INTENT_KEY</code>.
Example:</p>
<pre><code class="language-xml">&lt;activity
    android:name="io.projectliberty.helpers.AuthCallbackActivity"
    ...
    &lt;intent-filter android:autoVerify="true"&gt;
        ...
        &lt;data
                android:scheme="http"
                android:host="localhost"
                android:port="3000"
                android:path="/login/callback" /&gt;
    &lt;/intent-filter&gt;
    &lt;intent-filter android:autoVerify="true"&gt;
        ... or ...
        &lt;data
                android:scheme="siwfdemoapp"
                android:host="login" /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre>
<h2 id="4-process-authorization-code-1"><a class="header" href="#4-process-authorization-code-1">4. Process Authorization Code</a></h2>
<p>On your backend service, process the authorization code and start your session.</p>
<p>Resources:</p>
<ul>
<li><a href="SDK/../Actions/Response.html">Documentation on Processing a Result</a></li>
<li><a href="https://projectlibertylabs.github.io/gateway/GettingStarted/SSO.html">Frequency Gateway SSO Tutorial</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ios-siwf-sdk"><a class="header" href="#ios-siwf-sdk">iOS SIWF SDK</a></h1>
<h2 id="quick-reference-3"><a class="header" href="#quick-reference-3">Quick Reference</a></h2>
<ul>
<li><a href="https://github.com/ProjectLibertyLabs/siwf-sdk-ios">SIWF iOS SDK Source Code + Demo App</a></li>
<li><a href="https://swiftpackageindex.com/ProjectLibertyLabs/siwf-sdk-ios">Swift Package: <code>https://github.com/ProjectLibertyLabs/siwf-sdk-ios.git</code></a></li>
</ul>
<h2 id="1-installation-2"><a class="header" href="#1-installation-2">1. Installation</a></h2>
<h3 id="requirements-1"><a class="header" href="#requirements-1">Requirements</a></h3>
<ul>
<li>iOS 15.0 or later</li>
<li>Swift Package Manager</li>
</ul>
<h3 id="installing-the-siwf-sdk-1"><a class="header" href="#installing-the-siwf-sdk-1">Installing the SIWF SDK</a></h3>
<p>You can install the SIWF SDK via <strong>Swift Package Manager (SPM)</strong>:</p>
<ol>
<li>Open Xcode and navigate to <strong>File → Add Packages</strong>.</li>
<li>Enter the repository URL: <code>https://github.com/ProjectLibertyLabs/siwf-sdk-ios.git</code></li>
<li>Select the latest stable version and add it to your project.</li>
</ol>
<p><a href="https://developer.apple.com/documentation/xcode/adding-package-dependencies-to-your-app">Xcode Documentation Reference</a></p>
<h2 id="2-displaying-the-siwf-button-2"><a class="header" href="#2-displaying-the-siwf-button-2">2. Displaying the SIWF Button</a></h2>
<p>To create a SIWF Button, use the <code>Siwf.createSignInButton</code> method:</p>
<pre><code class="language-swift">import Siwf

Siwf.createSignInButton(mode: .primary, authRequest: authRequest)
</code></pre>
<p><code>authRequest</code> requires the <a href="SDK/../Actions/Start.html#step-1-generate-the-signed-request-payload">Signed Request Payload</a> in either <code>base64url</code> encoded or structured form.</p>
<h2 id="3-handling-authorization-callbacks-2"><a class="header" href="#3-handling-authorization-callbacks-2">3. Handling Authorization Callbacks</a></h2>
<p>Use <code>onOpenURL</code> and <code>Siwf.handleRedirectUrl</code> to handle deep links and retrieve the authentication code.</p>
<h2 id="4-process-authorization-code-2"><a class="header" href="#4-process-authorization-code-2">4. Process Authorization Code</a></h2>
<p>On your backend service, process the authorization code and start your session.</p>
<p>Resources:</p>
<ul>
<li><a href="SDK/../Actions/Response.html">Documentation on Processing a Result</a></li>
<li><a href="https://projectlibertylabs.github.io/gateway/GettingStarted/SSO.html">Frequency Gateway SSO Tutorial</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-siwf-sdk"><a class="header" href="#web-siwf-sdk">Web SIWF SDK</a></h1>
<h2 id="quick-reference-4"><a class="header" href="#quick-reference-4">Quick Reference</a></h2>
<ul>
<li><a href="https://github.com/ProjectLibertyLabs/siwf/tree/main/libraries/sdk-web#readme">SIWF Web SDK Source Code + Example</a></li>
<li><a href="https://www.npmjs.com/package/@projectlibertylabs/siwf-sdk-web">NPM Package: <code>@projectlibertylabs/siwf-sdk-web</code></a></li>
<li><a href="https://www.jsdelivr.com/package/npm/@projectlibertylabs/siwf-sdk-web">jsDelivr: <code>https://cdn.jsdelivr.net/npm/@projectlibertylabs/siwf-sdk-web@1.0.1/siwf-sdk-web.min.js</code></a></li>
</ul>
<h2 id="1-installation-3"><a class="header" href="#1-installation-3">1. Installation</a></h2>
<p>Simply include the SDK in your HTML from <a href="https://www.jsdelivr.com/package/npm/@projectlibertylabs/siwf-sdk-web">jsDelivr</a> (update the version as needed):</p>
<pre><code class="language-html">&lt;script src="https://cdn.jsdelivr.net/npm/@projectlibertylabs/siwf-sdk-web@1.0.1/siwf-sdk-web.min.js"&gt;&lt;/script&gt;
</code></pre>
<p>Or download from <a href="https://github.com/ProjectLibertyLabs/siwf/releases?q=sdk-web&amp;expanded=true">GitHub Releases</a> and include it locally:</p>
<pre><code class="language-html">&lt;script src="path/to/siwf-sdk-web.min.js"&gt;&lt;/script&gt;
</code></pre>
<h2 id="2-displaying-the-siwf-button-3"><a class="header" href="#2-displaying-the-siwf-button-3">2. Displaying the SIWF Button</a></h2>
<p>To create a SIWF Button, use the <code>Siwf.createSignInButton</code> method:</p>
<pre><code class="language-html">&lt;!-- Add a button container with data attributes --&gt;
&lt;div data-siwf-button="YOUR_ENCODED_SIGNED_REQUEST" data-siwf-mode="primary" data-siwf-endpoint="mainnet"&gt;&lt;/div&gt;
</code></pre>
<p><code>data-siwf-button</code> requires the <a href="SDK/../Actions/Start.html#step-1-generate-the-signed-request-payload">Signed Request Payload</a> in <code>base64url</code> encoded form.</p>
<p>You can also use a <a href="https://github.com/ProjectLibertyLabs/siwf/tree/main/libraries/sdk-web#option-b-javascript-implementation">JavaScript render call</a>.</p>
<h2 id="3-handling-authorization-callbacks-3"><a class="header" href="#3-handling-authorization-callbacks-3">3. Handling Authorization Callbacks</a></h2>
<p>You will need to handle the callback URL specified and extract the <code>authorizationCode</code> parameter from the callback and passing it to your backend service.</p>
<h2 id="4-process-authorization-code-3"><a class="header" href="#4-process-authorization-code-3">4. Process Authorization Code</a></h2>
<p>On your backend service, process the authorization code and start your session.</p>
<p>Resources:</p>
<ul>
<li><a href="SDK/../Actions/Response.html">Documentation on Processing a Result</a></li>
<li><a href="https://projectlibertylabs.github.io/gateway/GettingStarted/SSO.html">Frequency Gateway SSO Tutorial</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <!-- MOD: Show names and Chevrons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- MOD START: Custom Footer -->
        <footer id="footer">
        </footer>
        <!-- MOD END: Custom Footer -->





        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
