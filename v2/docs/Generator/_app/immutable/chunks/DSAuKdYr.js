import{d as j,e as I}from"./nSUhbBYz.js";function C(n){return n("return this")}const d=typeof globalThis<"u"?globalThis:typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:C(Function);function B(n,t){return typeof d[n]>"u"?t:d[n]}let k=class{encode(t){const e=t.length,r=new Uint8Array(e);for(let o=0;o<e;o++)r[o]=t.charCodeAt(o);return r}};const L=B("TextEncoder",k);function F(n){return typeof n=="function"}function M(){return Number.NaN}const $=B("BigInt",M),A="0123456789abcdef",y=new Uint8Array(256),R=new Uint8Array(256*256);for(let n=0,t=A.length;n<t;n++)y[A[n].charCodeAt(0)|0]=n|0,n>9&&(y[A[n].toUpperCase().charCodeAt(0)|0]=n|0);for(let n=0;n<256;n++){const t=n<<8;for(let e=0;e<256;e++)R[t|e]=y[n]<<4|y[e]}function N(n,t=-1){if(!n)return new Uint8Array;let e=n.startsWith("0x")?2:0;const r=Math.ceil((n.length-e)/2),o=Math.ceil(t===-1?r:t/8),c=new Uint8Array(o),s=o>r?o-r:0;for(let i=s;i<o;i++,e+=2)c[i]=R[n.charCodeAt(e)<<8|n.charCodeAt(e+1)];return c}const X=/^0x[\da-fA-F]+$/;function D(n,t=-1,e){return typeof n=="string"&&(n==="0x"||X.test(n))&&(t===-1?n.length%2===0:n.length===2+Math.ceil(t/4))}function H(n){return!!n&&typeof n=="object"}function z(...n){return t=>H(t)&&n.every(e=>F(t[e]))}typeof $=="function"&&$.asIntN;const G=typeof d.Buffer=="function"&&typeof d.Buffer.isBuffer=="function";d.process;function V(n){return G&&!!n&&F(n.readDoubleLE)&&d.Buffer.isBuffer(n)}function q(n){return(n&&n.constructor)===Uint8Array||n instanceof Uint8Array}const Y=new L;function J(n){return n?Y.encode(n.toString()):new Uint8Array}function u(n,t=!1){if(t&&n==null)throw new Error("u8aToU8a: Expected non-null, non-undefined value");return q(n)?V(n)?new Uint8Array(n):n:D(n)?N(n):Array.isArray(n)?new Uint8Array(n):J(n)}function K(n,t=0){const e=n.length;let r=0;if(!t)for(let c=0;c<e;c++)t+=n[c].length;const o=new Uint8Array(t);for(let c=0;c<e;c++)o.set(n[c],r),r+=n[c].length;return o}function p(n,t){const e=u(n),r=u(t);if(e.length===r.length){const o=new DataView(e.buffer,e.byteOffset),c=new DataView(r.buffer,r.byteOffset),s=e.length%4|0,i=e.length-s|0;for(let a=0;a<i;a+=4)if(o.getUint32(a)!==c.getUint32(a))return!1;for(let a=i,f=e.length;a<f;a++)if(e[a]!==r[a])return!1;return!0}return!1}const U=u(`Ethereum Signed Message:
`),w=u("<Bytes>"),b=u("</Bytes>"),Q=w.length+b.length;function S(n,t){return n.length>=Q&&p(n.subarray(0,w.length),w)&&p(n.slice(-b.length),b)||t&&n.length>=U.length&&p(n.subarray(0,U.length),U)}function Z(n){const t=u(n);return S(t,!1)?t.subarray(w.length,t.length-b.length):t}function v(n){const t=u(n);return S(t,!0)?t:K([w,t,b])}const nn=z("catch","then");function tn(n,...t){const e=new Set(["__proto__","constructor","prototype"]);for(let r=0,o=t.length;r<o;r++){const c=t[r];if(c)if(typeof c.entries=="function")for(const[s,i]of c.entries())e.has(s)||(n[s]=i);else{const s=Object.create(null);for(const[i,a]of Object.entries(c))e.has(i)||(s[i]=a);Object.assign(n,s)}}return n}function en(n){return new Promise(t=>{document.readyState==="complete"?t(n()):window.addEventListener("load",()=>t(n()))})}const fn={name:"@polkadot/extension-dapp",path:import.meta&&import.meta.url?new URL(import.meta.url).pathname.substring(0,new URL(import.meta.url).pathname.lastIndexOf("/")+1):"auto",type:"esm",version:"0.61.2"},un=Z,ln=v,g=window;g.injectedWeb3=g.injectedWeb3||{};let rn=T(),l=null;function T(){return Object.values(g.injectedWeb3).filter(({connect:n,enable:t})=>!!(n||t)).length!==0}function P(n){throw new Error(`${n}: web3Enable(originName) needs to be called before ${n}`)}function W(n,t,e){return t.map(({address:r,genesisHash:o,name:c,type:s})=>({address:r.length===42?r:I(j(r),e),meta:{genesisHash:o,name:c,source:n},type:s}))}function _(n,t,e){return n.filter(r=>(!r.type||!e||e.includes(r.type))&&(!r.genesisHash||!t||r.genesisHash===t))}function on(n){return Promise.all(Object.entries(g.injectedWeb3).map(([t,{connect:e,enable:r,version:o}])=>Promise.resolve().then(()=>e?e(n):r?r(n).then(c=>tn({name:t,version:o||"unknown"},c)):Promise.reject(new Error("No connect(..) or enable(...) hook found"))).catch(({message:c})=>{console.error(`Error initializing ${t}: ${c}`)}))).then(t=>t.filter(e=>!!e))}async function O(n,t){return l?(await l).filter(({name:r})=>!t||t.includes(r)):P(n)}function dn(n,t=[]){if(!n)throw new Error("You must pass a name for your app to the web3Enable function");const e=t.length?Promise.all(t.map(r=>r().catch(()=>!1))):Promise.resolve([!0]);return l=en(()=>e.then(()=>on(n).then(r=>r.map(o=>(o.accounts.subscribe||(o.accounts.subscribe=c=>(o.accounts.get().then(c).catch(console.error),()=>{})),o))).catch(()=>[]).then(r=>{const o=r.map(({name:c,version:s})=>`${c}/${s}`);return rn=T(),console.info(`web3Enable: Enabled ${r.length} extension${r.length!==1?"s":""}: ${o.join(", ")}`),r}))),l}async function cn({accountType:n,extensions:t,genesisHash:e,ss58Format:r}={}){const o=[],c=await O("web3Accounts",t);return(await Promise.all(c.map(async({accounts:i,name:a})=>{try{const f=await i.get();return W(a,_(f,e,n),r)}catch{return[]}}))).forEach(i=>{o.push(...i)}),console.info(`web3Accounts: Found ${o.length} address${o.length!==1?"es":""}`),o}async function hn(n,{accountType:t,extensions:e,genesisHash:r,ss58Format:o}={}){const c=await O("web3AccountsSubscribe",e),s={},i=()=>n(Object.entries(s).reduce((f,[m,E])=>(f.push(...W(m,_(E,r,t),o)),f),[])),a=c.map(({accounts:{subscribe:f},name:m})=>f(E=>{s[m]=E;try{const h=i();h&&nn(h)&&h.catch(console.error)}catch(h){console.error(h)}}));return()=>{a.forEach(f=>{f()})}}async function x(n){if(!l)return P("web3FromSource");const t=await l,e=n&&t.find(({name:r})=>r===n);if(!e)throw new Error(`web3FromSource: Unable to find an injected ${n}`);return e}async function wn(n){if(!l)return P("web3FromAddress");const t=await cn();let e;if(n){const r=j(n);e=t.find(o=>p(j(o.address),r))}if(!e)throw new Error(`web3FromAddress: Unable to find injected ${n}`);return x(e.meta.source)}async function bn(n){const{provider:t}=await x(n);return t?t.listProviders():(console.warn(`Extension ${n} does not expose any provider`),null)}async function pn(n,t){const{provider:e}=await x(n);if(!e)throw new Error(`Extension ${n} does not expose any provider`);return{meta:await e.startProvider(t),provider:e}}export{rn as isWeb3Injected,fn as packageInfo,un as unwrapBytes,cn as web3Accounts,hn as web3AccountsSubscribe,dn as web3Enable,l as web3EnablePromise,wn as web3FromAddress,x as web3FromSource,bn as web3ListRpcProviders,pn as web3UseRpcProvider,ln as wrapBytes};
