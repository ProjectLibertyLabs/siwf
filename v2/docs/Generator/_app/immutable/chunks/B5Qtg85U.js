import{d as j,e as I}from"./DDPItZwv.js";function C(t){return t("return this")}const d=typeof globalThis<"u"?globalThis:typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:C(Function);function B(t,n){return typeof d[t]>"u"?n:d[t]}let k=class{encode(n){const e=n.length,r=new Uint8Array(e);for(let o=0;o<e;o++)r[o]=n.charCodeAt(o);return r}};const L=B("TextEncoder",k);function F(t){return typeof t=="function"}function M(){return Number.NaN}const $=B("BigInt",M),E="0123456789abcdef",y=new Uint8Array(256),R=new Uint8Array(256*256);for(let t=0,n=E.length;t<n;t++)y[E[t].charCodeAt(0)|0]=t|0,t>9&&(y[E[t].toUpperCase().charCodeAt(0)|0]=t|0);for(let t=0;t<256;t++){const n=t<<8;for(let e=0;e<256;e++)R[n|e]=y[t]<<4|y[e]}function N(t,n=-1){if(!t)return new Uint8Array;let e=t.startsWith("0x")?2:0;const r=Math.ceil((t.length-e)/2),o=Math.ceil(n===-1?r:n/8),c=new Uint8Array(o),s=o>r?o-r:0;for(let i=s;i<o;i++,e+=2)c[i]=R[t.charCodeAt(e)<<8|t.charCodeAt(e+1)];return c}const X=/^0x[\da-fA-F]+$/;function D(t,n=-1,e){return typeof t=="string"&&(t==="0x"||X.test(t))&&(n===-1?t.length%2===0:t.length===2+Math.ceil(n/4))}function H(t){return!!t&&typeof t=="object"}function z(...t){return n=>H(n)&&t.every(e=>F(n[e]))}typeof $=="function"&&$.asIntN;const G=typeof d.Buffer=="function"&&typeof d.Buffer.isBuffer=="function";d.process;function V(t){return G&&!!t&&F(t.readDoubleLE)&&d.Buffer.isBuffer(t)}function q(t){return(t&&t.constructor)===Uint8Array||t instanceof Uint8Array}const Y=new L;function J(t){return t?Y.encode(t.toString()):new Uint8Array}function u(t){return q(t)?V(t)?new Uint8Array(t):t:D(t)?N(t):Array.isArray(t)?new Uint8Array(t):J(t)}function K(t,n=0){const e=t.length;let r=0;if(!n)for(let c=0;c<e;c++)n+=t[c].length;const o=new Uint8Array(n);for(let c=0;c<e;c++)o.set(t[c],r),r+=t[c].length;return o}function p(t,n){const e=u(t),r=u(n);if(e.length===r.length){const o=new DataView(e.buffer,e.byteOffset),c=new DataView(r.buffer,r.byteOffset),s=e.length%4|0,i=e.length-s|0;for(let a=0;a<i;a+=4)if(o.getUint32(a)!==c.getUint32(a))return!1;for(let a=i,f=e.length;a<f;a++)if(e[a]!==r[a])return!1;return!0}return!1}const U=u(`Ethereum Signed Message:
`),w=u("<Bytes>"),b=u("</Bytes>"),Q=w.length+b.length;function S(t,n){return t.length>=Q&&p(t.subarray(0,w.length),w)&&p(t.slice(-b.length),b)||n&&t.length>=U.length&&p(t.subarray(0,U.length),U)}function Z(t){const n=u(t);return S(n,!1)?n.subarray(w.length,n.length-b.length):n}function v(t){const n=u(t);return S(n,!0)?n:K([w,n,b])}const tt=z("catch","then");function nt(t,...n){const e=new Set(["__proto__","constructor","prototype"]);for(let r=0,o=n.length;r<o;r++){const c=n[r];if(c)if(typeof c.entries=="function")for(const[s,i]of c.entries())e.has(s)||(t[s]=i);else{const s=Object.create(null);for(const[i,a]of Object.entries(c))e.has(i)||(s[i]=a);Object.assign(t,s)}}return t}function et(t){return new Promise(n=>{document.readyState==="complete"?n(t()):window.addEventListener("load",()=>n(t()))})}const at={name:"@polkadot/extension-dapp",path:import.meta&&import.meta.url?new URL(import.meta.url).pathname.substring(0,new URL(import.meta.url).pathname.lastIndexOf("/")+1):"auto",type:"esm",version:"0.59.2"},ft=Z,ut=v,g=window;g.injectedWeb3=g.injectedWeb3||{};let rt=W(),l=null;function W(){return Object.values(g.injectedWeb3).filter(({connect:t,enable:n})=>!!(t||n)).length!==0}function P(t){throw new Error(`${t}: web3Enable(originName) needs to be called before ${t}`)}function _(t,n,e){return n.map(({address:r,genesisHash:o,name:c,type:s})=>({address:r.length===42?r:I(j(r),e),meta:{genesisHash:o,name:c,source:t},type:s}))}function O(t,n,e){return t.filter(r=>(!r.type||!e||e.includes(r.type))&&(!r.genesisHash||!n||r.genesisHash===n))}function ot(t){return Promise.all(Object.entries(g.injectedWeb3).map(([n,{connect:e,enable:r,version:o}])=>Promise.resolve().then(()=>e?e(t):r?r(t).then(c=>nt({name:n,version:o||"unknown"},c)):Promise.reject(new Error("No connect(..) or enable(...) hook found"))).catch(({message:c})=>{console.error(`Error initializing ${n}: ${c}`)}))).then(n=>n.filter(e=>!!e))}async function T(t,n){return l?(await l).filter(({name:r})=>!n||n.includes(r)):P(t)}function lt(t,n=[]){if(!t)throw new Error("You must pass a name for your app to the web3Enable function");const e=n.length?Promise.all(n.map(r=>r().catch(()=>!1))):Promise.resolve([!0]);return l=et(()=>e.then(()=>ot(t).then(r=>r.map(o=>(o.accounts.subscribe||(o.accounts.subscribe=c=>(o.accounts.get().then(c).catch(console.error),()=>{})),o))).catch(()=>[]).then(r=>{const o=r.map(({name:c,version:s})=>`${c}/${s}`);return rt=W(),console.info(`web3Enable: Enabled ${r.length} extension${r.length!==1?"s":""}: ${o.join(", ")}`),r}))),l}async function ct({accountType:t,extensions:n,genesisHash:e,ss58Format:r}={}){const o=[],c=await T("web3Accounts",n);return(await Promise.all(c.map(async({accounts:i,name:a})=>{try{const f=await i.get();return _(a,O(f,e,t),r)}catch{return[]}}))).forEach(i=>{o.push(...i)}),console.info(`web3Accounts: Found ${o.length} address${o.length!==1?"es":""}`),o}async function dt(t,{accountType:n,extensions:e,genesisHash:r,ss58Format:o}={}){const c=await T("web3AccountsSubscribe",e),s={},i=()=>t(Object.entries(s).reduce((f,[m,A])=>(f.push(..._(m,O(A,r,n),o)),f),[])),a=c.map(({accounts:{subscribe:f},name:m})=>f(A=>{s[m]=A;try{const h=i();h&&tt(h)&&h.catch(console.error)}catch(h){console.error(h)}}));return()=>{a.forEach(f=>{f()})}}async function x(t){if(!l)return P("web3FromSource");const n=await l,e=t&&n.find(({name:r})=>r===t);if(!e)throw new Error(`web3FromSource: Unable to find an injected ${t}`);return e}async function ht(t){if(!l)return P("web3FromAddress");const n=await ct();let e;if(t){const r=j(t);e=n.find(o=>p(j(o.address),r))}if(!e)throw new Error(`web3FromAddress: Unable to find injected ${t}`);return x(e.meta.source)}async function wt(t){const{provider:n}=await x(t);return n?n.listProviders():(console.warn(`Extension ${t} does not expose any provider`),null)}async function bt(t,n){const{provider:e}=await x(t);if(!e)throw new Error(`Extension ${t} does not expose any provider`);return{meta:await e.startProvider(n),provider:e}}export{rt as isWeb3Injected,at as packageInfo,ft as unwrapBytes,ct as web3Accounts,dt as web3AccountsSubscribe,lt as web3Enable,l as web3EnablePromise,ht as web3FromAddress,x as web3FromSource,wt as web3ListRpcProviders,bt as web3UseRpcProvider,ut as wrapBytes};
